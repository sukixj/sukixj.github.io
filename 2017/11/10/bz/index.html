<!DOCTYPE html>



  


<html class="theme-next gemini use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="NOIP 复习," />










<meta property="og:type" content="article">
<meta property="og:title" content="考前的板子硬邦邦">
<meta property="og:url" content="http://sukixj.github.io/2017/11/10/bz/index.html">
<meta property="og:site_name" content="Yuki">
<meta property="og:image" content="https://i.loli.net/2017/11/25/5a18e6b32b3e6.jpg">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/8471136-76b5047bcadeb07e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/8471136-a12dd236618107c1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/8471136-84aba54020b59468.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/8471136-ab8df48547644243.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/8471136-a233ff584744eef0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/8471136-b7fd1f06b8cf6aab.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/8471136-0b09ea09a9155abd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/8471136-f58fc6d668b73b60.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/8471136-48c72d5145271757.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/8471136-5d361082356f0da5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="http://upload-images.jianshu.io/upload_images/8471136-b58d31dac4ea2596.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2017-11-25T03:44:54.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="考前的板子硬邦邦">
<meta name="twitter:image" content="https://i.loli.net/2017/11/25/5a18e6b32b3e6.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://sukixj.github.io/2017/11/10/bz/"/>





  <title>考前的板子硬邦邦 | Yuki</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Yuki</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">It's You</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-links">
          <a href="/links" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            友情链接
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://sukixj.github.io/2017/11/10/bz/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Yuki">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Yuki">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">考前的板子硬邦邦</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-10T08:42:22+08:00">
                2017-11-10
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><img src="https://i.loli.net/2017/11/25/5a18e6b32b3e6.jpg" alt="65706791_p0.jpg"></p>
<a id="more"></a>
<h2 id="最长公共子序列"><a href="#最长公共子序列" class="headerlink" title="最长公共子序列"></a>最长公共子序列</h2><ul>
<li><h4 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h4>给出1-n的两个排列P1和P2，求它们的最长公共子序列。</li>
<li><h4 id="输入输出格式"><a href="#输入输出格式" class="headerlink" title="输入输出格式"></a>输入输出格式</h4></li>
</ul>
<p><strong>输入格式：</strong></p>
<blockquote>
<p>第一行是一个数n，<br>接下来两行，每行为n个数，为自然数1-n的一个排列。</p>
</blockquote>
<p><strong>输出格式：</strong></p>
<blockquote>
<p>一个数，即最长公共子序列的长度</p>
</blockquote>
<ul>
<li><h4 id="输入输出样例"><a href="#输入输出样例" class="headerlink" title="输入输出样例"></a>输入输出样例</h4></li>
</ul>
<p><strong>输入样例#1：</strong></p>
<blockquote>
<p>5<br>3 2 1 4 5<br>1 2 3 4 5</p>
</blockquote>
<p><strong>输出样例#1：</strong></p>
<blockquote>
<p>3</p>
</blockquote>
<ul>
<li><h4 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h4>【数据规模】<br>对于50%的数据，n≤1000<br>对于100%的数据，n≤100000</li>
</ul>
<p><strong>转化成最长上升子序列然后 nlogn 解决。</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 1000005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 233333333</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n,a[MAXN],b[MAXN],f[MAXN],cnt;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,gg;i&lt;=n;i++) &#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;gg);</div><div class="line">		a[gg]=i;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,gg;i&lt;=n;i++) &#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;gg);</div><div class="line">		<span class="keyword">if</span>(a[gg]&gt;<span class="number">0</span>) b[cnt++]=a[gg];</div><div class="line">	&#125;</div><div class="line">	fill(f,f+n,INF);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;cnt;i++) &#123;</div><div class="line">		*lower_bound(f,f+cnt,b[i])=b[i];</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d"</span>,lower_bound(f,f+cnt,INF)-f);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="最小（最大）生成树"><a href="#最小（最大）生成树" class="headerlink" title="最小（最大）生成树"></a>最小（最大）生成树</h2><ul>
<li><h4 id="题目描述-1"><a href="#题目描述-1" class="headerlink" title="题目描述"></a>题目描述</h4></li>
</ul>
<p>如题，给出一个无向图，求出最小生成树，如果该图不连通，则输出orz</p>
<ul>
<li><h4 id="输入输出格式-1"><a href="#输入输出格式-1" class="headerlink" title="输入输出格式"></a>输入输出格式</h4></li>
</ul>
<p><strong>输入格式：</strong></p>
<blockquote>
<p>第一行包含两个整数N、M，表示该图共有N个结点和M条无向边。（N&lt;=5000，M&lt;=200000）<br>接下来M行每行包含三个整数Xi、Yi、Zi，表示有一条长度为Zi的无向边连接结点Xi、Yi</p>
</blockquote>
<p><strong>输出格式：</strong></p>
<blockquote>
<p>输出包含一个数，即最小生成树的各边的长度之和；如果该图不连通则输出orz</p>
</blockquote>
<ul>
<li><h4 id="输入输出样例-1"><a href="#输入输出样例-1" class="headerlink" title="输入输出样例"></a>输入输出样例</h4></li>
</ul>
<p><strong>输入样例#1：</strong></p>
<blockquote>
<p>1 2 2<br>1 3 2<br>1 4 3<br>2 3 4<br>3 4 3</p>
</blockquote>
<p><strong>输出样例#1：</strong></p>
<blockquote>
<p>7</p>
</blockquote>
<ul>
<li><h4 id="说明-1"><a href="#说明-1" class="headerlink" title="说明"></a>说明</h4>时空限制：1000ms,128M<br>数据规模：<br>对于20%的数据：N&lt;=5，M&lt;=20<br>对于40%的数据：N&lt;=50，M&lt;=2500<br>对于70%的数据：N&lt;=500，M&lt;=10000<br>对于100%的数据：N&lt;=5000，M&lt;=200000<br>样例解释：<br><img src="http://upload-images.jianshu.io/upload_images/8471136-76b5047bcadeb07e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br>所以最小生成树的总边权为2+2+3=7</li>
</ul>
<p><strong>kruskal不断加小边，直到加到n-1条边图就变成了树。</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 200005</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">struct</span> edge &#123;</div><div class="line">	<span class="keyword">int</span> u,v,w;</div><div class="line">&#125;e[MAXN];</div><div class="line"><span class="keyword">int</span> n,m,tot;</div><div class="line"><span class="keyword">int</span> fa[MAXN];</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">comp</span><span class="params">(edge a,edge b)</span> </span>&#123;</div><div class="line">	<span class="keyword">return</span> a.w&lt;b.w;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">	<span class="keyword">if</span>(fa[x]!=x) <span class="keyword">return</span> fa[x]=find(fa[x]);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span> </span>&#123;</div><div class="line">	fa[find(x)]=fa[find(y)];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Kruskal</span><span class="params">()</span> </span>&#123;</div><div class="line">	sort(e+<span class="number">1</span>,e+<span class="number">1</span>+m,comp);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,gg=<span class="number">0</span>;i&lt;=m;i++) &#123;</div><div class="line">		<span class="keyword">if</span>(find(e[i].u)!=find(e[i].v)) &#123;</div><div class="line">			merge(e[i].u,e[i].v);</div><div class="line">			tot+=e[i].w;</div><div class="line">			gg++;</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span>(gg==n<span class="number">-1</span>) <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) fa[i]=i;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++) &#123;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;e[i].u,&amp;e[i].v,&amp;e[i].w);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(Kruskal()) <span class="built_in">cout</span>&lt;&lt;tot;</div><div class="line">	<span class="keyword">else</span> <span class="built_in">cout</span>&lt;&lt;<span class="string">"orz"</span>;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="并查集"><a href="#并查集" class="headerlink" title="并查集"></a>并查集</h2><ul>
<li><h4 id="题目描述-2"><a href="#题目描述-2" class="headerlink" title="题目描述"></a>题目描述</h4>如题，现在有一个并查集，你需要完成合并和查询操作。</li>
<li><h4 id="输入输出格式-2"><a href="#输入输出格式-2" class="headerlink" title="输入输出格式"></a>输入输出格式</h4></li>
</ul>
<p><strong>输入格式：</strong></p>
<blockquote>
<p>第一行包含两个整数N、M，表示共有N个元素和M个操作。<br>接下来M行，每行包含三个整数Zi、Xi、Yi<br>当Zi=1时，将Xi与Yi所在的集合合并<br>当Zi=2时，输出Xi与Yi是否在同一集合内，是的话输出Y；否则话输出N</p>
</blockquote>
<p><strong>输出格式：</strong></p>
<blockquote>
<p>如上，对于每一个Zi=2的操作，都有一行输出，每行包含一个大写字母，为Y或者N</p>
</blockquote>
<ul>
<li><h4 id="输入输出样例-2"><a href="#输入输出样例-2" class="headerlink" title="输入输出样例"></a>输入输出样例</h4></li>
</ul>
<p><strong>输入样例#1：</strong></p>
<blockquote>
<p>4 7<br>2 1 2<br>1 1 2<br>2 1 2<br>1 3 4<br>2 1 4<br>1 2 3<br>2 1 4</p>
</blockquote>
<p><strong>输出样例#1：</strong></p>
<blockquote>
<p>N<br>Y<br>N<br>Y</p>
</blockquote>
<ul>
<li><h4 id="说明-2"><a href="#说明-2" class="headerlink" title="说明"></a>说明</h4>时空限制：1000ms,128M<br>数据规模：<br>对于30%的数据，N&lt;=10，M&lt;=20；<br>对于70%的数据，N&lt;=100，M&lt;=1000；<br>对于100%的数据，N&lt;=10000，M&lt;=200000。</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 10005</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n,m,fa[MAXN];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">find</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">	<span class="keyword">if</span>(fa[x]!=x) <span class="keyword">return</span> fa[x]=find(fa[x]);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span> </span>&#123;</div><div class="line">	fa[find(x)]=fa[find(y)];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) fa[i]=i;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++) &#123;</div><div class="line">		<span class="keyword">int</span> opt,x,y;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;opt,&amp;x,&amp;y);</div><div class="line">		<span class="keyword">if</span>(opt==<span class="number">1</span>) &#123;</div><div class="line">			<span class="keyword">if</span>(find(x)!=find(y)) merge(x,y);</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span> &#123;</div><div class="line">			<span class="keyword">if</span>(find(x)==find(y)) <span class="built_in">puts</span>(<span class="string">"Y"</span>);</div><div class="line">			<span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"N"</span>);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="单源最短路"><a href="#单源最短路" class="headerlink" title="单源最短路"></a>单源最短路</h2><ul>
<li><h4 id="题目描述-3"><a href="#题目描述-3" class="headerlink" title="题目描述"></a>题目描述</h4>如题，给出一个有向图，请输出从某一点出发到所有点的最短路径长度。</li>
<li><h4 id="输入输出格式-3"><a href="#输入输出格式-3" class="headerlink" title="输入输出格式"></a>输入输出格式</h4></li>
</ul>
<p><strong>输入格式：</strong></p>
<blockquote>
<p>第一行包含三个整数N、M、S，分别表示点的个数、有向边的个数、出发点的编号。<br>接下来M行每行包含三个整数Fi、Gi、Wi，分别表示第i条有向边的出发点、目标点和长度。</p>
</blockquote>
<p><strong>输出格式：</strong></p>
<blockquote>
<p>一行，包含N个用空格分隔的整数，其中第i个整数表示从点S出发到点i的最短路径长度（若S=i则最短路径长度为0，若从点S无法到达点i，则最短路径长度为2147483647）</p>
</blockquote>
<h2 id="输入输出样例-3"><a href="#输入输出样例-3" class="headerlink" title="输入输出样例"></a>输入输出样例</h2><p><strong>输入样例#1：</strong></p>
<blockquote>
<p>4 6 1<br>1 2 2<br>2 3 2<br>2 4 1<br>1 3 5<br>3 4 3<br>1 4 4</p>
</blockquote>
<p><strong>输出样例#1：</strong></p>
<blockquote>
<p>0 2 4 3</p>
</blockquote>
<ul>
<li><h4 id="说明-3"><a href="#说明-3" class="headerlink" title="说明"></a>说明</h4>时空限制：1000ms,128M<br>数据规模：<br>对于20%的数据：N&lt;=5，M&lt;=15<br>对于40%的数据：N&lt;=100，M&lt;=10000<br>对于70%的数据：N&lt;=1000，M&lt;=100000<br>对于100%的数据：N&lt;=10000，M&lt;=500000<br>样例说明：<br><img src="http://upload-images.jianshu.io/upload_images/8471136-a12dd236618107c1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></li>
</ul>
<p><strong>SPFA</strong><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 1001000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">'0'</span> || ch&gt;<span class="string">'9'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">-1</span>;ch=getchar();&#125;</div><div class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span> &amp;&amp; ch&lt;=<span class="string">'9'</span>)&#123;x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>;ch=getchar();&#125;</div><div class="line">    <span class="keyword">return</span> x*f;</div><div class="line">&#125;</div><div class="line"><span class="keyword">struct</span> <span class="built_in">queue</span> &#123;</div><div class="line">    <span class="keyword">int</span> Q[<span class="number">500005</span>],head,tail;</div><div class="line">    <span class="built_in">queue</span>() &#123;</div><div class="line">        head=<span class="number">0</span>,tail=<span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">push</span><span class="params">(<span class="keyword">int</span> a)</span> </span>&#123;</div><div class="line">        Q[++tail]=a;</div><div class="line">        <span class="keyword">return</span> ;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pop</span><span class="params">()</span> </span>&#123;</div><div class="line">        head++;</div><div class="line">        <span class="keyword">return</span> ;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">empty</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> head&gt;=tail;</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">front</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> Q[head+<span class="number">1</span>];</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</div><div class="line">        <span class="keyword">if</span>(head&lt;=tail) <span class="keyword">return</span> tail-head; </div><div class="line">    &#125; </div><div class="line">&#125;;</div><div class="line"><span class="keyword">struct</span> Edge &#123;</div><div class="line">    <span class="keyword">int</span> next,to,cost;</div><div class="line">&#125;e[maxn];</div><div class="line"><span class="keyword">int</span> num,head[maxn&lt;&lt;<span class="number">1</span>],dist[maxn],vis[maxn],n,m,s;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> w)</span> </span>&#123;</div><div class="line">    num++;</div><div class="line">    e[num].to=v;</div><div class="line">    e[num].cost=w;</div><div class="line">    e[num].next=head[u];</div><div class="line">    head[u]=num;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">clearlove</span><span class="params">()</span></span>&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=<span class="number">10010</span>;i++)dist[i]=<span class="number">2147483647</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">spfa</span><span class="params">(<span class="keyword">int</span> s)</span> </span>&#123;</div><div class="line">    clearlove();</div><div class="line">    <span class="built_in">queue</span> q;</div><div class="line">    dist[s]=<span class="number">0</span>;</div><div class="line">    vis[s]=<span class="number">1</span>;</div><div class="line">    q.push(s);</div><div class="line">    <span class="keyword">while</span>(!q.empty()) &#123;</div><div class="line">        <span class="keyword">int</span> u=q.front();</div><div class="line">        q.pop();</div><div class="line">        vis[u]=<span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=head[u];i;i=e[i].next) &#123;</div><div class="line">            <span class="keyword">int</span> to=e[i].to;</div><div class="line">            <span class="keyword">if</span>(dist[to]&gt;dist[u]+e[i].cost) &#123;</div><div class="line">                dist[to]=dist[u]+e[i].cost;</div><div class="line">                <span class="keyword">if</span>(!vis[to]) &#123;</div><div class="line">                    vis[to]=<span class="number">1</span>;</div><div class="line">                    q.push(to);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    n=read(),m=read(),s=read();</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++) &#123;</div><div class="line">        <span class="keyword">int</span> u=read(),v=read(),w=read();</div><div class="line">        insert(u,v,w);</div><div class="line">    &#125;</div><div class="line">    spfa(s);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</div><div class="line">    <span class="built_in">printf</span>(<span class="string">"%d "</span>,dist[i]);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="最近公共祖先（LCA）"><a href="#最近公共祖先（LCA）" class="headerlink" title="最近公共祖先（LCA）"></a>最近公共祖先（LCA）</h2><ul>
<li><h4 id="题目描述-4"><a href="#题目描述-4" class="headerlink" title="题目描述"></a>题目描述</h4>如题，给定一棵有根多叉树，请求出指定两个点直接最近的公共祖先。</li>
<li><h4 id="输入输出格式-4"><a href="#输入输出格式-4" class="headerlink" title="输入输出格式"></a>输入输出格式</h4></li>
</ul>
<p><strong>输入格式：</strong></p>
<blockquote>
<p>第一行包含三个正整数N、M、S，分别表示树的结点个数、询问的个数和树根结点的序号。<br>接下来N-1行每行包含两个正整数x、y，表示x结点和y结点之间有一条直接连接的边（数据保证可以构成树）。<br>接下来M行每行包含两个正整数a、b，表示询问a结点和b结点的最近公共祖先。</p>
</blockquote>
<p><strong>输出格式：</strong></p>
<blockquote>
<p>输出包含M行，每行包含一个正整数，依次为每一个询问的结果。</p>
<ul>
<li><h4 id="输入输出样例-4"><a href="#输入输出样例-4" class="headerlink" title="输入输出样例"></a>输入输出样例</h4></li>
</ul>
</blockquote>
<p><strong>输入样例#1：</strong></p>
<blockquote>
<p>5 5 4<br>3 1<br>2 4<br>5 1<br>1 4<br>2 4<br>3 2<br>3 5<br>1 2<br>4 5</p>
</blockquote>
<p><strong>输出样例#1：</strong></p>
<blockquote>
<p>4<br>4<br>1<br>4<br>4</p>
</blockquote>
<ul>
<li><h4 id="说明-4"><a href="#说明-4" class="headerlink" title="说明"></a>说明</h4>时空限制：1000ms,128M<br>数据规模：<br>对于30%的数据：N&lt;=10，M&lt;=10<br>对于70%的数据：N&lt;=10000，M&lt;=10000<br>对于100%的数据：N&lt;=500000，M&lt;=500000<br>样例说明：<br>该树结构如下：<br><img src="http://upload-images.jianshu.io/upload_images/8471136-84aba54020b59468.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""><br>第一次询问：2、4的最近公共祖先，故为4。<br>第二次询问：3、2的最近公共祖先，故为4。<br>第三次询问：3、5的最近公共祖先，故为1。<br>第四次询问：1、2的最近公共祖先，故为4。<br>第五次询问：4、5的最近公共祖先，故为4。<br>故输出依次为4、4、1、4、4。</li>
</ul>
<p><strong>倍增</strong><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 5000500</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">'0'</span> || ch&gt;<span class="string">'9'</span>) &#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">-1</span>;ch=getchar();&#125;</div><div class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span> &amp;&amp; ch&lt;=<span class="string">'9'</span>) &#123;x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>;ch=getchar();&#125;</div><div class="line">    <span class="keyword">return</span> x*f;</div><div class="line">&#125;</div><div class="line"><span class="keyword">struct</span> edge &#123;</div><div class="line">    <span class="keyword">int</span> u,v,next;</div><div class="line">&#125;e[MAXN];</div><div class="line"><span class="keyword">int</span> num,head[MAXN],n,m,s;</div><div class="line"><span class="keyword">int</span> fa[MAXN][<span class="number">30</span>],deep[MAXN];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">    num++;</div><div class="line">    e[num].v=v;</div><div class="line">    e[num].next=head[u];</div><div class="line">    head[u]=num;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">    deep[x]=deep[fa[x][<span class="number">0</span>]]+<span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;fa[x][i];i++) fa[x][i+<span class="number">1</span>]=fa[fa[x][i]][i];</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=head[x];i;i=e[i].next) &#123;</div><div class="line">        <span class="keyword">if</span>(!deep[e[i].v]) &#123;</div><div class="line">            fa[e[i].v][<span class="number">0</span>]=x;</div><div class="line">            dfs(e[i].v);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(deep[x]&gt;deep[y]) swap(x,y);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">20</span>;i&gt;=<span class="number">0</span>;i--) &#123;</div><div class="line">        <span class="keyword">if</span>(deep[fa[y][i]]&gt;=deep[x]) y=fa[y][i];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(x==y) <span class="keyword">return</span> x;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">20</span>;i&gt;=<span class="number">0</span>;i--) &#123;</div><div class="line">        <span class="keyword">if</span>(fa[x][i]!=fa[y][i]) x=fa[x][i],y=fa[y][i];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> fa[x][<span class="number">0</span>];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    n=read(),m=read(),s=read();</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++) &#123;</div><div class="line">        <span class="keyword">int</span> u=read(),v=read();</div><div class="line">        insert(u,v);</div><div class="line">        insert(v,u);</div><div class="line">    &#125;</div><div class="line">    dfs(s);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++) &#123;</div><div class="line">        <span class="keyword">int</span> x=read(),y=read();</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,lca(x,y));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>树链剖分</strong><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 500005</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n,m,s,fa[MAXN],deep[MAXN],size[MAXN],top[MAXN];</div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vec[MAXN];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">    size[x]=<span class="number">1</span>;</div><div class="line">    deep[x]=deep[fa[x]]+<span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;vec[x].size(); i++) &#123;</div><div class="line">        <span class="keyword">if</span>(fa[x]!=vec[x][i]) &#123;</div><div class="line">            fa[vec[x][i]]=x;</div><div class="line">            dfs(vec[x][i]);</div><div class="line">            size[x]+=size[vec[x][i]];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Get_heavy_edge</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> s=<span class="number">0</span>;</div><div class="line">    <span class="keyword">if</span>(!top[x]) top[x]=x;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;vec[x].size();i++) &#123;</div><div class="line">        <span class="keyword">if</span>(fa[x]!=vec[x][i]&amp;&amp;size[vec[x][i]]&gt;size[s])s=vec[x][i];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(s) &#123;</div><div class="line">        top[s]=top[x];</div><div class="line">        Get_heavy_edge(s);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;vec[x].size();i++) &#123;</div><div class="line">        <span class="keyword">if</span>(fa[x]!=vec[x][i]&amp;&amp;vec[x][i]!=s) Get_heavy_edge(vec[x][i]);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">lca</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span> </span>&#123;</div><div class="line">    <span class="keyword">for</span>(;top[x]!=top[y];) &#123;</div><div class="line">        <span class="keyword">if</span>(deep[top[x]]&lt;deep[top[y]]) swap(x,y);</div><div class="line">        x=fa[top[x]];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(deep[x]&gt;deep[y]) swap(x,y);</div><div class="line">    <span class="keyword">return</span> x;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;n,&amp;m,&amp;s);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n<span class="number">-1</span>;i++) &#123;</div><div class="line">        <span class="keyword">int</span> u,v;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;u,&amp;v);</div><div class="line">        vec[u].push_back(v);</div><div class="line">        vec[v].push_back(u);</div><div class="line">    &#125;</div><div class="line">    dfs(s);</div><div class="line">    Get_heavy_edge(s);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++) &#123;</div><div class="line">        <span class="keyword">int</span> x,y;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;x,&amp;y);</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,lca(x,y));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="负环"><a href="#负环" class="headerlink" title="负环"></a>负环</h2><ul>
<li><h4 id="题目描述-5"><a href="#题目描述-5" class="headerlink" title="题目描述"></a>题目描述</h4>暴力枚举/SPFA/Bellman-ford/奇怪的贪心/超神搜索</li>
<li><h4 id="输入输出格式-5"><a href="#输入输出格式-5" class="headerlink" title="输入输出格式"></a>输入输出格式</h4></li>
</ul>
<p><strong>输入格式：</strong></p>
<blockquote>
<p>第一行一个正整数T表示数据组数，对于每组数据：<br>第一行两个正整数N M，表示图有N个顶点，M条边<br>接下来M行，每行三个整数a b w，表示a-&gt;b有一条权值为w的边（若w&lt;0则为单向，否则双向）</p>
</blockquote>
<p><strong>输出格式：</strong></p>
<blockquote>
<p>共T行。对于每组数据，存在负环则输出一行”YE5”(不含引号)，否则输出一行”N0”(不含引号)。</p>
</blockquote>
<ul>
<li><h4 id="输入输出样例-5"><a href="#输入输出样例-5" class="headerlink" title="输入输出样例"></a>输入输出样例</h4></li>
</ul>
<p><strong>输入样例#1：</strong></p>
<blockquote>
<p>2<br>3 4<br>1 2 2<br>1 3 4<br>2 3 1<br>3 1 -3<br>3 3<br>1 2 3<br>2 3 4<br>3 1 -8</p>
</blockquote>
<p><strong>输出样例#1：</strong></p>
<blockquote>
<p>N0<br>YE5</p>
</blockquote>
<ul>
<li><h4 id="说明-5"><a href="#说明-5" class="headerlink" title="说明"></a>说明</h4>N,M,|w|≤200 000；1≤a,b≤N；T≤10 建议复制输出格式中的字符串。<br>此题普通Bellman-Ford或BFS-SPFA会TLE</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 200005</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">'0'</span> || ch&gt;<span class="string">'9'</span>) &#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">-1</span>;ch=getchar();&#125;</div><div class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span> &amp;&amp; ch&lt;=<span class="string">'9'</span>) &#123;x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>;ch=getchar();&#125;</div><div class="line">    <span class="keyword">return</span> x*f;</div><div class="line">&#125;</div><div class="line"><span class="keyword">struct</span> edge &#123;</div><div class="line">    <span class="keyword">int</span> u,v,w,next;</div><div class="line">&#125;e[MAXN&lt;&lt;<span class="number">1</span>];</div><div class="line"><span class="keyword">int</span> n,m,t;</div><div class="line"><span class="keyword">int</span> num,head[MAXN&lt;&lt;<span class="number">1</span>];</div><div class="line"><span class="keyword">int</span> vis[MAXN],dis[MAXN];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> w)</span> </span>&#123;</div><div class="line">    num++;</div><div class="line">    e[num].v=v;</div><div class="line">    e[num].next=head[u];</div><div class="line">    e[num].w=w;</div><div class="line">    head[u]=num;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;</div><div class="line">    num=<span class="number">0</span>;</div><div class="line">    <span class="built_in">memset</span>(e,<span class="number">0</span>,<span class="keyword">sizeof</span>(e));</div><div class="line">    <span class="built_in">memset</span>(head,<span class="number">0</span>,<span class="keyword">sizeof</span>(head));</div><div class="line">    <span class="built_in">memset</span>(dis,<span class="number">0</span>,<span class="keyword">sizeof</span>(dis));</div><div class="line">    <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="keyword">sizeof</span>(vis));</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">spfa_dfs</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</div><div class="line">    vis[u]=<span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> k=head[u];k;k=e[k].next) &#123;</div><div class="line">        <span class="keyword">int</span> v=e[k].v,w=e[k].w;</div><div class="line">        <span class="keyword">if</span>(dis[u]+w&lt;dis[v]) &#123;</div><div class="line">            dis[v]=dis[u]+w;</div><div class="line">            <span class="keyword">if</span>(!vis[v]) &#123;</div><div class="line">                <span class="keyword">if</span>(spfa_dfs(v)) <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">            &#125; </div><div class="line">            <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    vis[u]=<span class="number">0</span>;</div><div class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    t=read();</div><div class="line">    <span class="keyword">while</span>(t--) &#123;</div><div class="line">        clear();</div><div class="line">        n=read();</div><div class="line">        m=read();</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++) &#123;</div><div class="line">            <span class="keyword">int</span> u=read(),v=read(),w=read();</div><div class="line">            <span class="keyword">if</span>(w&lt;<span class="number">0</span>) insert(u,v,w);</div><div class="line">            <span class="keyword">else</span> &#123;</div><div class="line">                insert(u,v,w);</div><div class="line">                insert(v,u,w);</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">bool</span> flag=<span class="literal">false</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) &#123;</div><div class="line">            <span class="keyword">if</span>(flag) <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">if</span>(spfa_dfs(i)) flag=<span class="literal">true</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span>(flag) <span class="built_in">puts</span>(<span class="string">"YE5"</span>);</div><div class="line">        <span class="keyword">else</span> <span class="built_in">puts</span>(<span class="string">"N0"</span>);</div><div class="line">    &#125; </div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="缩点"><a href="#缩点" class="headerlink" title="缩点"></a>缩点</h2><ul>
<li><h4 id="题目背景"><a href="#题目背景" class="headerlink" title="题目背景"></a>题目背景</h4>缩点+DP</li>
<li><h4 id="题目描述-6"><a href="#题目描述-6" class="headerlink" title="题目描述"></a>题目描述</h4>给定一个n个点m条边有向图，每个点有一个权值，求一条路径，使路径经过的点权值之和最大。你只需要求出这个权值和。<br>允许多次经过一条边或者一个点，但是，重复经过的点，权值只计算一次。</li>
<li><h4 id="输入输出格式-6"><a href="#输入输出格式-6" class="headerlink" title="输入输出格式"></a>输入输出格式</h4></li>
</ul>
<p><strong>输入格式：</strong></p>
<blockquote>
<p>第一行，n,m<br>第二行，n个整数，依次代表点权<br>第三至m+2行，每行两个整数u,v，表示u-&gt;v有一条有向边</p>
</blockquote>
<p><strong>输出格式：</strong></p>
<blockquote>
<p>共一行，最大的点权之和。</p>
</blockquote>
<ul>
<li><h4 id="输入输出样例-6"><a href="#输入输出样例-6" class="headerlink" title="输入输出样例"></a>输入输出样例</h4></li>
</ul>
<p><strong>输入样例#1：</strong></p>
<blockquote>
<p>2 2<br>1 1<br>1 2<br>2 1</p>
</blockquote>
<p><strong>输出样例#1：</strong></p>
<blockquote>
<p>2</p>
</blockquote>
<ul>
<li><h4 id="说明-6"><a href="#说明-6" class="headerlink" title="说明"></a>说明</h4>n&lt;=10^4,m&lt;=10^5,|点权|&lt;=1000 算法：Tarjan缩点+DAGdp</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 10005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXM 500005</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">struct</span> edge &#123;</div><div class="line">    <span class="keyword">int</span> u,v,next;</div><div class="line">&#125;e[MAXM&lt;&lt;<span class="number">1</span>];</div><div class="line"><span class="keyword">int</span> num,head[MAXN&lt;&lt;<span class="number">1</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">ins</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">    num++;</div><div class="line">    e[num].u=u;</div><div class="line">    e[num].v=v;</div><div class="line">    e[num].next=head[u];</div><div class="line">    head[u]=num;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> cnt,DFN[MAXN],LOW[MAXN],Time,belong[MAXN],<span class="built_in">stack</span>[MAXN],top;</div><div class="line"><span class="keyword">bool</span> inst[MAXN];</div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; bcc[MAXN];</div><div class="line"><span class="keyword">int</span> n,m,w[MAXN],gg[MAXN];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">tarjan</span><span class="params">(<span class="keyword">int</span> u)</span> </span>&#123;</div><div class="line">    LOW[u]=DFN[u]=++Time;</div><div class="line">    inst[u]=<span class="literal">true</span>;</div><div class="line">    <span class="built_in">stack</span>[top++]=u;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=head[u];i;i=e[i].next) &#123;</div><div class="line">        <span class="keyword">int</span> v=e[i].v;</div><div class="line">        <span class="keyword">if</span>(inst[v]) &#123;</div><div class="line">            LOW[u]=min(LOW[u],DFN[v]);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(!DFN[v]) &#123;</div><div class="line">            tarjan(v);</div><div class="line">            LOW[u]=min(LOW[u],LOW[v]);</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span>(LOW[u]==DFN[u]) &#123;</div><div class="line">        <span class="keyword">int</span> now;</div><div class="line">        cnt++;</div><div class="line">        <span class="keyword">do</span> &#123;</div><div class="line">            now=<span class="built_in">stack</span>[--top];</div><div class="line">            inst[now]=<span class="literal">false</span>;</div><div class="line">            belong[now]=cnt;</div><div class="line">            bcc[cnt].push_back(now);</div><div class="line">            w[cnt]+=gg[now];</div><div class="line">        &#125; <span class="keyword">while</span>(now!=u);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; G[MAXN];</div><div class="line"><span class="keyword">int</span> du[MAXN];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Shrinking_point</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++) &#123;</div><div class="line">        <span class="keyword">int</span> u=belong[e[i].u],v=belong[e[i].v];</div><div class="line">        <span class="keyword">if</span>(u!=v) G[u].push_back(v),du[v]++;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">struct</span> <span class="built_in">queue</span> &#123;</div><div class="line">	<span class="keyword">int</span> Q[<span class="number">500005</span>],head,tail;</div><div class="line">	<span class="built_in">queue</span>() &#123;</div><div class="line">		head=<span class="number">0</span>,tail=<span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">push</span><span class="params">(<span class="keyword">int</span> a)</span> </span>&#123;</div><div class="line">		Q[++tail]=a;</div><div class="line">		<span class="keyword">return</span> ;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">pop</span><span class="params">()</span> </span>&#123;</div><div class="line">		head++;</div><div class="line">		<span class="keyword">return</span> ;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">empty</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> head&gt;=tail;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">front</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> Q[head+<span class="number">1</span>];</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">int</span> <span class="title">size</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">if</span>(head&lt;=tail) <span class="keyword">return</span> tail-head; </div><div class="line">	&#125; </div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;</div><div class="line">		head=tail=<span class="number">0</span>;</div><div class="line">		<span class="built_in">memset</span>(Q,<span class="number">0</span>,<span class="keyword">sizeof</span>(Q));</div><div class="line">	&#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">int</span> dist[MAXN],ans;</div><div class="line"><span class="keyword">bool</span> vis[MAXN];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">clearlove</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=cnt;i++) dist[i]=<span class="number">0</span>;</div><div class="line">    fill(vis,vis+cnt+<span class="number">1</span>,<span class="literal">false</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">SPFA</span><span class="params">(<span class="keyword">int</span> s)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> res=<span class="number">0</span>;</div><div class="line">	clearlove();</div><div class="line">    <span class="built_in">queue</span> q;</div><div class="line">    dist[s]=w[s];</div><div class="line">    vis[s]=<span class="number">1</span>;</div><div class="line">    q.push(s);</div><div class="line">    <span class="keyword">while</span>(!q.empty()) &#123;</div><div class="line">        <span class="keyword">int</span> u=q.front();</div><div class="line">        q.pop();</div><div class="line">        vis[u]=<span class="number">0</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;G[u].size();i++) &#123;</div><div class="line">            <span class="keyword">int</span> to=G[u][i];</div><div class="line">            <span class="keyword">if</span>(dist[to]&lt;dist[u]+w[to]) &#123;</div><div class="line">                dist[to]=dist[u]+w[to];</div><div class="line">                <span class="keyword">if</span>(!vis[to]) &#123;</div><div class="line">                    vis[to]=<span class="number">1</span>;</div><div class="line">                    q.push(to);</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=cnt;i++) res=max(res,dist[i]);</div><div class="line">    <span class="keyword">return</span> res;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;gg[i]);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++) &#123;</div><div class="line">        <span class="keyword">int</span> u,v;</div><div class="line">        <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;u,&amp;v);</div><div class="line">        ins(u,v);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) <span class="keyword">if</span>(!DFN[i]) tarjan(i);</div><div class="line">    Shrinking_point();</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=cnt;i++) &#123;</div><div class="line">    	<span class="keyword">if</span>(!du[i]) &#123;</div><div class="line">    		ans=max(ans,SPFA(i));</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d"</span>,ans);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="割点"><a href="#割点" class="headerlink" title="割点"></a>割点</h2><ul>
<li><h4 id="题目背景-1"><a href="#题目背景-1" class="headerlink" title="题目背景"></a>题目背景</h4>割点</li>
<li><h4 id="题目描述-7"><a href="#题目描述-7" class="headerlink" title="题目描述"></a>题目描述</h4>给出一个n个点，m条边的无向图，求图的割点。</li>
<li><h4 id="输入输出格式-7"><a href="#输入输出格式-7" class="headerlink" title="输入输出格式"></a>输入输出格式</h4></li>
</ul>
<p><strong>输入格式：</strong></p>
<blockquote>
<p>第一行输入n,m<br>下面m行每行输入x,y表示x到y有一条边</p>
</blockquote>
<p><strong>输出格式：</strong></p>
<blockquote>
<p>第一行输出割点个数<br>第二行按照节点编号从小到大输出节点，用空格隔开</p>
</blockquote>
<ul>
<li><h4 id="输入输出样例-7"><a href="#输入输出样例-7" class="headerlink" title="输入输出样例"></a>输入输出样例</h4><strong>输入样例#1：</strong><blockquote>
<p>6 7<br>1 2<br>1 3<br>1 4<br>2 5<br>3 5<br>4 5<br>5 6</p>
</blockquote>
</li>
</ul>
<p><strong>输出样例#1：</strong></p>
<blockquote>
<p>1<br>5</p>
</blockquote>
<ul>
<li><h4 id="说明-7"><a href="#说明-7" class="headerlink" title="说明"></a>说明</h4>n,m均为100000<br>tarjan 图不一定联通！！！</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 100005</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">	<span class="keyword">while</span>(ch&lt;<span class="string">'0'</span> || ch&gt;<span class="string">'9'</span>) &#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">-1</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span> &amp;&amp; ch&lt;=<span class="string">'9'</span>) &#123;x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">return</span> x*f;</div><div class="line">&#125;</div><div class="line"><span class="keyword">struct</span> edge &#123;</div><div class="line">	<span class="keyword">int</span> u,v,next;</div><div class="line">&#125;e[MAXN&lt;&lt;<span class="number">1</span>];</div><div class="line"><span class="keyword">int</span> head[MAXN&lt;&lt;<span class="number">1</span>],num;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">ins</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v)</span> </span>&#123;</div><div class="line">	num++;</div><div class="line">	e[num].u=u;</div><div class="line">	e[num].v=v;</div><div class="line">	e[num].next=head[u];</div><div class="line">	head[u]=num;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> n,m,ans;</div><div class="line"><span class="keyword">int</span> dfn[MAXN],low[MAXN],Time;</div><div class="line"><span class="keyword">bool</span> cut[MAXN],in[MAXN];</div><div class="line"><span class="keyword">int</span> root,child;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">tarjan</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> fa)</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> child=<span class="number">0</span>;</div><div class="line">	dfn[u]=low[u]=++Time;</div><div class="line">	in[u]=<span class="literal">true</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=head[u];i;i=e[i].next) &#123;</div><div class="line">		<span class="keyword">int</span> v=e[i].v;</div><div class="line">		<span class="keyword">if</span>(in[v] &amp;&amp; v!=fa) &#123;</div><div class="line">			low[u]=min(low[u],dfn[v]);</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(!dfn[v]) &#123;</div><div class="line">			tarjan(v,u);</div><div class="line">			child++;</div><div class="line">			low[u]=min(low[u],low[v]);</div><div class="line">			<span class="keyword">if</span>((fa!=root &amp;&amp; dfn[u]&lt;=low[v]) || (fa==root &amp;&amp; child&gt;<span class="number">1</span>)) &#123;</div><div class="line">				<span class="keyword">if</span>(!cut[u]) ans++;</div><div class="line">				cut[u]=<span class="literal">true</span>;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	n=read(),m=read();</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++) &#123;</div><div class="line">		<span class="keyword">int</span> u=read(),v=read();</div><div class="line">		ins(u,v);</div><div class="line">		ins(v,u);</div><div class="line">	&#125;</div><div class="line">	root=<span class="number">-1</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) <span class="keyword">if</span>(!dfn[i]) tarjan(i,root);</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ans);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) <span class="keyword">if</span>(cut[i]) <span class="built_in">printf</span>(<span class="string">"%d "</span>,i);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="网络最大流"><a href="#网络最大流" class="headerlink" title="网络最大流"></a>网络最大流</h2><ul>
<li><h4 id="题目描述-8"><a href="#题目描述-8" class="headerlink" title="题目描述"></a>题目描述</h4><p>如题，给出一个网络图，以及其源点和汇点，求出其网络最大流。</p>
</li>
<li><h4 id="输入输出格式-8"><a href="#输入输出格式-8" class="headerlink" title="输入输出格式"></a>输入输出格式</h4></li>
</ul>
<p><strong>输入格式：</strong></p>
<blockquote>
<p>第一行包含四个正整数N、M、S、T，分别表示点的个数、有向边的个数、源点序号、汇点序号。<br>接下来M行每行包含三个正整数ui、vi、wi，表示第i条有向边从ui出发，到达vi，边权为wi（即该边最大流量为wi）</p>
</blockquote>
<p><strong>输出格式：</strong></p>
<blockquote>
<p>一行，包含一个正整数，即为该网络的最大流。</p>
</blockquote>
<ul>
<li><h4 id="输入输出样例-8"><a href="#输入输出样例-8" class="headerlink" title="输入输出样例"></a>输入输出样例</h4></li>
</ul>
<p><strong>输入样例#1：</strong></p>
<blockquote>
<p>4 5 4 3<br>4 2 30<br>4 3 20<br>2 3 20<br>2 1 30<br>1 3 40</p>
</blockquote>
<p><strong>输出样例#1：</strong></p>
<blockquote>
<p>50</p>
</blockquote>
<ul>
<li><h4 id="说明-8"><a href="#说明-8" class="headerlink" title="说明"></a>说明</h4>时空限制：1000ms,128M<br>数据规模：<br>对于30%的数据：N<a href="=10，M&lt;=25
对于70%的数据：N&lt;=200，M&lt;=1000
对于100%的数据：N&lt;=10000，M&lt;=100000
样例说明：
![image](http://upload-images.jianshu.io/upload_images/8471136-db2fc2596be3ec8d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
题目中存在3条路径：
4--">=10，M&lt;=25
对于70%的数据：N&lt;=200，M&lt;=1000
对于100%的数据：N&lt;=10000，M&lt;=100000
样例说明：
![image](http://upload-images.jianshu.io/upload_images/8471136-db2fc2596be3ec8d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)
题目中存在3条路径：
4--</a>2–&gt;3，该路线可通过20的流量<br>4–&gt;3，可通过20的流量<br>4–&gt;2–&gt;1–&gt;3，可通过10的流量（边4–&gt;2之前已经耗费了20的流量）<br>故流量总计20+20+10=50。输出50。</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 200005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXM 500005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> INF 0x7fffffff</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">	<span class="keyword">while</span>(ch&lt;<span class="string">'0'</span> || ch&gt;<span class="string">'9'</span>) &#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">-1</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span> &amp;&amp; ch&lt;=<span class="string">'9'</span>) &#123;x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">return</span> x*f;</div><div class="line">&#125;</div><div class="line"><span class="keyword">struct</span> edge &#123;</div><div class="line">	<span class="keyword">int</span> u,v,f,next;</div><div class="line">&#125;e[MAXN&lt;&lt;<span class="number">1</span>];</div><div class="line"><span class="keyword">int</span> head[MAXN&lt;&lt;<span class="number">1</span>],num;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">ins</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> f)</span> </span>&#123;</div><div class="line">	num++;</div><div class="line">	e[num].u=u;</div><div class="line">	e[num].v=v;</div><div class="line">	e[num].f=f;</div><div class="line">	e[num].next=head[u];</div><div class="line">	head[u]=num;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> n,m,S,T,ans;</div><div class="line"><span class="keyword">int</span> qu[MAXN&lt;&lt;<span class="number">1</span>],deep[MAXN&lt;&lt;<span class="number">1</span>];</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">bfs</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> h=<span class="number">0</span>,t=<span class="number">1</span>;</div><div class="line">	<span class="built_in">memset</span>(deep,<span class="number">-1</span>,<span class="keyword">sizeof</span>(deep));</div><div class="line">	qu[h]=S;</div><div class="line">	deep[S]=<span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(h&lt;t) &#123;</div><div class="line">		<span class="keyword">int</span> u=qu[h++];</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=head[u];i;i=e[i].next) &#123;</div><div class="line">			<span class="keyword">int</span> v=e[i].v;</div><div class="line">			<span class="keyword">if</span>(deep[v]==<span class="number">-1</span> &amp;&amp; e[i].f) &#123;</div><div class="line">				deep[v]=deep[u]+<span class="number">1</span>;</div><div class="line">				qu[t++]=v;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(deep[T]!=<span class="number">-1</span>) <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> f)</span> </span>&#123;</div><div class="line">	<span class="keyword">if</span>(u==T || f&lt;=<span class="number">0</span>) <span class="keyword">return</span> f;</div><div class="line">	<span class="keyword">int</span> rest=<span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=head[u];i;i=e[i].next) &#123;</div><div class="line">		<span class="keyword">int</span> v=e[i].v;</div><div class="line">		<span class="keyword">if</span>(deep[v]==deep[u]+<span class="number">1</span>) &#123;</div><div class="line">			<span class="keyword">int</span> new_flow=dfs(v,min(f-rest,e[i].f));</div><div class="line">			e[i].f-=new_flow;</div><div class="line">			e[i^<span class="number">1</span>].v+=new_flow;</div><div class="line">			rest+=new_flow;</div><div class="line">			<span class="keyword">if</span>(rest==f) <span class="keyword">return</span> f;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(!rest) deep[u]=<span class="number">-1</span>;</div><div class="line">	<span class="keyword">return</span> rest;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dinic</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">while</span>(bfs()) ans+=dfs(S,INF);</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d"</span>,ans);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	n=read(),m=read(),S=read(),T=read();</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++) &#123;</div><div class="line">		<span class="keyword">int</span> u=read(),v=read(),f=read();</div><div class="line">		ins(u,v,f);</div><div class="line">		ins(v,u,<span class="number">0</span>);</div><div class="line">	&#125;</div><div class="line">	dinic();</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="二分图匹配"><a href="#二分图匹配" class="headerlink" title="二分图匹配"></a>二分图匹配</h2><ul>
<li><h4 id="题目背景-2"><a href="#题目背景-2" class="headerlink" title="题目背景"></a>题目背景</h4>二分图</li>
<li><h4 id="题目描述-9"><a href="#题目描述-9" class="headerlink" title="题目描述"></a>题目描述</h4><p>给定一个二分图，结点个数分别为n,m，边数为e，求二分图最大匹配数</p>
</li>
<li><h4 id="输入输出格式-9"><a href="#输入输出格式-9" class="headerlink" title="输入输出格式"></a>输入输出格式</h4></li>
</ul>
<p><strong>输入格式：</strong></p>
<blockquote>
<p>第一行，n,m,e<br>第二至e+1行，每行两个正整数u,v，表示u,v有一条连边</p>
</blockquote>
<p><strong>输出格式：</strong></p>
<blockquote>
<p>共一行，二分图最大匹配</p>
<ul>
<li><h4 id="输入输出样例-9"><a href="#输入输出样例-9" class="headerlink" title="输入输出样例"></a>输入输出样例</h4></li>
</ul>
</blockquote>
<p><strong>输入样例#1：</strong></p>
<blockquote>
<p>1 1 1<br>1 1</p>
</blockquote>
<p><strong>输出样例#1：</strong></p>
<blockquote>
<p>1</p>
</blockquote>
<ul>
<li><h4 id="说明-9"><a href="#说明-9" class="headerlink" title="说明"></a>说明</h4><img src="http://upload-images.jianshu.io/upload_images/8471136-ab8df48547644243.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></li>
</ul>
<p><strong>网络流算法</strong><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 550000</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">	<span class="keyword">while</span>(ch&lt;<span class="string">'0'</span> || ch&gt;<span class="string">'9'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">-1</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span> &amp;&amp; ch&lt;=<span class="string">'9'</span>)&#123;x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">return</span> x*f;</div><div class="line">&#125;</div><div class="line"><span class="keyword">struct</span> edge &#123;</div><div class="line">	<span class="keyword">int</span> to,next,v;</div><div class="line">&#125;e[<span class="number">550000</span>];</div><div class="line"><span class="keyword">int</span> head[MAXN&lt;&lt;<span class="number">1</span>],ne=<span class="number">1</span>,q[MAXN&lt;&lt;<span class="number">1</span>],h[MAXN&lt;&lt;<span class="number">1</span>],ans,n,m,S,T,ee;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ins</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> f)</span> </span>&#123;</div><div class="line">	ne++;</div><div class="line">	e[ne].to=v;</div><div class="line">	e[ne].next=head[u];</div><div class="line">	e[ne].v=f;</div><div class="line">	head[u]=ne;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> u,<span class="keyword">int</span> v,<span class="keyword">int</span> f)</span> </span>&#123;</div><div class="line">	ins(u,v,f);ins(v,u,<span class="number">0</span>);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">bfs</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> t=<span class="number">0</span>,w=<span class="number">1</span>;</div><div class="line">	<span class="built_in">memset</span>(h,<span class="number">-1</span>,<span class="keyword">sizeof</span>(h));</div><div class="line">	q[t]=S;h[S]=<span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(t&lt;w) &#123;</div><div class="line">		<span class="keyword">int</span> now=q[t++];</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=head[now];i;i=e[i].next) &#123;	</div><div class="line">			<span class="keyword">int</span> v=e[i].to;</div><div class="line">			<span class="keyword">if</span>(h[v]==<span class="number">-1</span> &amp;&amp; e[i].v) &#123;</div><div class="line">				h[v]=h[now]+<span class="number">1</span>;</div><div class="line">				q[w++]=v;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(h[T]!=<span class="number">-1</span>) <span class="keyword">return</span> <span class="number">1</span>;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> f)</span> </span>&#123;</div><div class="line">	<span class="keyword">if</span>(x==T || f&lt;=<span class="number">0</span>) <span class="keyword">return</span> f;</div><div class="line">	<span class="keyword">int</span> w,used=<span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=head[x];i;i=e[i].next) &#123;</div><div class="line">		<span class="keyword">int</span> v=e[i].to;</div><div class="line">		<span class="keyword">if</span>(h[v]==h[x]+<span class="number">1</span>) &#123;</div><div class="line">			w=dfs(v,min(f-used,e[i].v));</div><div class="line">			e[i].v-=w;</div><div class="line">			e[i^<span class="number">1</span>].v+=w;</div><div class="line">			used+=w;</div><div class="line">			<span class="keyword">if</span>(used==f)<span class="keyword">return</span> f;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">if</span>(!used) h[x]=<span class="number">-1</span>;</div><div class="line">	<span class="keyword">return</span> used;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">dinic</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">while</span>(bfs())ans+=dfs(S,<span class="number">0x7fffffff</span>);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	n=read(),m=read(),ee=read();</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=ee;i++) &#123;</div><div class="line">		<span class="keyword">int</span> u=read(),v=read();</div><div class="line">		<span class="keyword">if</span>(v&gt;m) <span class="keyword">continue</span>;</div><div class="line">		insert(u,v+n,<span class="number">1</span>);</div><div class="line">	&#125;</div><div class="line">	S=<span class="number">0</span>,T=n+m+<span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) insert(S,i,<span class="number">1</span>);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++) insert(i+n,T,<span class="number">1</span>);</div><div class="line">	dinic();</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d"</span>,ans);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="树状数组"><a href="#树状数组" class="headerlink" title="树状数组"></a>树状数组</h2><ul>
<li><h4 id="题目描述-10"><a href="#题目描述-10" class="headerlink" title="题目描述"></a>题目描述</h4>如题，已知一个数列，你需要进行下面两种操作：<br>1.将某一个数加上x<br>2.求出某区间每一个数的和</li>
<li><h4 id="输入输出格式-10"><a href="#输入输出格式-10" class="headerlink" title="输入输出格式"></a>输入输出格式</h4></li>
</ul>
<p><strong>输入格式：</strong></p>
<blockquote>
<p>第一行包含两个整数N、M，分别表示该数列数字的个数和操作的总个数。<br>第二行包含N个用空格分隔的整数，其中第i个数字表示数列第i项的初始值。<br>接下来M行每行包含3个整数，表示一个操作，具体如下：<br>操作1： 格式：1 x k 含义：将第x个数加上k<br>操作2： 格式：2 x y 含义：输出区间[x,y]内每个数的和</p>
</blockquote>
<p><strong>输出格式：</strong></p>
<blockquote>
<p>输出包含若干行整数，即为所有操作2的结果。</p>
</blockquote>
<ul>
<li><h4 id="输入输出样例-10"><a href="#输入输出样例-10" class="headerlink" title="输入输出样例"></a>输入输出样例</h4></li>
</ul>
<p><strong>输入样例#1：</strong></p>
<blockquote>
<p>5 5<br>1 5 4 2 3<br>1 1 3<br>2 2 5<br>1 3 -1<br>1 4 2<br>2 1 4</p>
</blockquote>
<p><strong>输出样例#1：</strong></p>
<blockquote>
<p>14<br>16</p>
</blockquote>
<ul>
<li><h4 id="说明-10"><a href="#说明-10" class="headerlink" title="说明"></a>说明</h4>时空限制：1000ms,128M<br>数据规模：<br>对于30%的数据：N&lt;=8，M&lt;=10<br>对于70%的数据：N&lt;=10000，M&lt;=10000<br>对于100%的数据：N&lt;=500000，M&lt;=500000<br>样例说明：<br><img src="http://upload-images.jianshu.io/upload_images/8471136-a233ff584744eef0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"><br>故输出结果14、16</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 500005</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> a[MAXN],c[MAXN],n,m;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">lowbit</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">	<span class="keyword">return</span> x&amp;(-x);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> p,<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">	<span class="keyword">while</span>(p&lt;=n) &#123;</div><div class="line">		c[p]+=x;</div><div class="line">		p+=lowbit(p);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> ;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">sum</span><span class="params">(<span class="keyword">int</span> p)</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> sum=<span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(p) &#123;</div><div class="line">		sum+=c[p];</div><div class="line">		p-=lowbit(p);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> sum;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span> </span>&#123;</div><div class="line">	<span class="keyword">return</span> sum(r)-sum(l<span class="number">-1</span>);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) <span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;a[i]),modify(i,a[i]);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++) &#123;</div><div class="line">		<span class="keyword">int</span> id,x,y;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;id,&amp;x,&amp;y);</div><div class="line">		<span class="keyword">if</span>(id==<span class="number">1</span>) modify(x,y); </div><div class="line">		<span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,query(x,y));</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li><h4 id="题目描述-11"><a href="#题目描述-11" class="headerlink" title="题目描述"></a>题目描述</h4><p>如题，已知一个数列，你需要进行下面两种操作：<br>1.将某区间每一个数数加上x<br>2.求出某一个数的和</p>
</li>
<li><h4 id="输入输出格式-11"><a href="#输入输出格式-11" class="headerlink" title="输入输出格式"></a>输入输出格式</h4></li>
</ul>
<p><strong>输入格式：</strong></p>
<blockquote>
<p>第一行包含两个整数N、M，分别表示该数列数字的个数和操作的总个数。<br>第二行包含N个用空格分隔的整数，其中第i个数字表示数列第i项的初始值。<br>接下来M行每行包含2或4个整数，表示一个操作，具体如下：<br>操作1： 格式：1 x y k 含义：将区间[x,y]内每个数加上k<br>操作2： 格式：2 x 含义：输出第x个数的值</p>
</blockquote>
<p><strong>输出格式：</strong></p>
<blockquote>
<p>输出包含若干行整数，即为所有操作2的结果。</p>
</blockquote>
<ul>
<li><h4 id="输入输出样例-11"><a href="#输入输出样例-11" class="headerlink" title="输入输出样例"></a>输入输出样例</h4></li>
</ul>
<p><strong>输入样例#1：</strong></p>
<blockquote>
<p>5 5<br>1 5 4 2 3<br>1 2 4 2<br>2 3<br>1 1 5 -1<br>1 3 5 7<br>2 4</p>
</blockquote>
<p><strong>输出样例#1：</strong></p>
<blockquote>
<p>6<br>10</p>
</blockquote>
<ul>
<li><h4 id="说明-11"><a href="#说明-11" class="headerlink" title="说明"></a>说明</h4>时空限制：1000ms,128M<br>数据规模：<br>对于30%的数据：N&lt;=8，M&lt;=10<br>对于70%的数据：N&lt;=10000，M&lt;=10000<br>对于100%的数据：N&lt;=500000，M&lt;=500000<br>样例说明：<br><img src="http://upload-images.jianshu.io/upload_images/8471136-b7fd1f06b8cf6aab.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"><br>故输出结果为6、10</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 500000+5</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n,m,pre,c[maxn];</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">lowbit</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">	<span class="keyword">return</span> x&amp;(-x);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(<span class="keyword">int</span> pos,<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">	<span class="keyword">while</span>(pos&lt;=n) &#123;</div><div class="line">		c[pos]+=x;</div><div class="line">		pos+=lowbit(pos);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> ;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(<span class="keyword">int</span> pos)</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(pos&gt;<span class="number">0</span>) &#123;</div><div class="line">		ans+=c[pos];</div><div class="line">		pos-=lowbit(pos);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;n,&amp;m);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++) &#123;</div><div class="line">		<span class="keyword">int</span> x;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;x);</div><div class="line">		modify(i,x-pre);</div><div class="line">		pre=x;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">while</span>(m--) &#123;</div><div class="line">		<span class="keyword">int</span> id;</div><div class="line">		<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;id);</div><div class="line">		<span class="keyword">if</span>(id==<span class="number">1</span>) &#123;</div><div class="line">			<span class="keyword">int</span> l,r,k;</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">"%d%d%d"</span>,&amp;l,&amp;r,&amp;k);</div><div class="line">			modify(l,k);</div><div class="line">			modify(r+<span class="number">1</span>,-k);</div><div class="line">		&#125; <span class="keyword">else</span> &#123;</div><div class="line">			<span class="keyword">int</span> pos;</div><div class="line">			<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;pos);</div><div class="line">			<span class="built_in">printf</span>(<span class="string">"%d\n"</span>,query(pos));</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="线段树"><a href="#线段树" class="headerlink" title="线段树"></a>线段树</h2><ul>
<li><h4 id="题目描述-12"><a href="#题目描述-12" class="headerlink" title="题目描述"></a>题目描述</h4><p>如题，已知一个数列，你需要进行下面两种操作：<br>1.将某区间每一个数加上x<br>2.求出某区间每一个数的和</p>
</li>
<li><h4 id="输入输出格式-12"><a href="#输入输出格式-12" class="headerlink" title="输入输出格式"></a>输入输出格式</h4><p><strong>输入格式：</strong></p>
<blockquote>
<p>第一行包含两个整数N、M，分别表示该数列数字的个数和操作的总个数。<br>第二行包含N个用空格分隔的整数，其中第i个数字表示数列第i项的初始值。<br>接下来M行每行包含3或4个整数，表示一个操作，具体如下：<br>操作1： 格式：1 x y k 含义：将区间[x,y]内每个数加上k<br>操作2： 格式：2 x y 含义：输出区间[x,y]内每个数的和</p>
</blockquote>
</li>
</ul>
<p><strong>输出格式：</strong></p>
<blockquote>
<p>输出包含若干行整数，即为所有操作2的结果。</p>
</blockquote>
<ul>
<li><h4 id="输入输出样例-12"><a href="#输入输出样例-12" class="headerlink" title="输入输出样例"></a>输入输出样例</h4></li>
</ul>
<p><strong>输入样例#1：</strong></p>
<blockquote>
<p>5 5<br>1 5 4 2 3<br>2 2 4<br>1 2 3 2<br>2 3 4<br>1 1 5 1<br>2 1 4</p>
</blockquote>
<p><strong>输出样例#1：</strong></p>
<blockquote>
<p>11<br>8<br>20</p>
</blockquote>
<ul>
<li><h4 id="说明-12"><a href="#说明-12" class="headerlink" title="说明"></a>说明</h4>时空限制：1000ms,128M<br>数据规模：<br>对于30%的数据：N&lt;=8，M&lt;=10<br>对于70%的数据：N&lt;=1000，M&lt;=10000<br>对于100%的数据：N&lt;=100000，M&lt;=100000<br>（数据已经过加强^_^，保证在int64/long long数据范围内）<br>样例说明：<br><img src="http://upload-images.jianshu.io/upload_images/8471136-0b09ea09a9155abd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"></li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> lson l,m,rt&lt;&lt;1</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> rson m+1,r,rt&lt;&lt;1|1</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 1000005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="function"><span class="keyword">inline</span> ll <span class="title">read</span><span class="params">()</span> </span>&#123;</div><div class="line">	ll x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">	<span class="keyword">while</span>(ch&lt;<span class="string">'0'</span>||ch&gt;<span class="string">'9'</span>)&#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">-1</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span>&amp;&amp;ch&lt;=<span class="string">'9'</span>)&#123;x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>;ch=getchar();&#125;</div><div class="line">	<span class="keyword">return</span> x*f;</div><div class="line">&#125;</div><div class="line">ll a[maxn],sum[maxn&lt;&lt;<span class="number">2</span>],col[maxn&lt;&lt;<span class="number">2</span>];</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">update</span><span class="params">(ll rt)</span> </span>&#123;</div><div class="line">	sum[rt] = sum[rt&lt;&lt;<span class="number">1</span>] + sum[rt&lt;&lt;<span class="number">1</span>|<span class="number">1</span>];</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">color</span><span class="params">(ll l,ll r,ll rt,ll c)</span> </span>&#123;</div><div class="line">	col[rt]+=c;</div><div class="line">	sum[rt]+=c*(r-l+<span class="number">1</span>);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">push_col</span><span class="params">(ll l,ll r,ll rt)</span> </span>&#123;</div><div class="line">	<span class="keyword">if</span>(col[rt]) &#123;</div><div class="line">		ll m=(l+r)&gt;&gt;<span class="number">1</span>;</div><div class="line">		color(lson,col[rt]);</div><div class="line">		color(rson,col[rt]);</div><div class="line">		col[rt]=<span class="number">0</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(ll l,ll r,ll rt)</span> </span>&#123;</div><div class="line">	<span class="keyword">if</span>(l==r) &#123;</div><div class="line">		sum[rt] = a[l];</div><div class="line">		<span class="keyword">return</span> ;</div><div class="line">	&#125;</div><div class="line">	ll m=(l+r)&gt;&gt;<span class="number">1</span>;</div><div class="line">	build(lson);</div><div class="line">	build(rson);</div><div class="line">	update(rt);</div><div class="line">&#125;</div><div class="line"><span class="function">ll <span class="title">query</span><span class="params">(ll l,ll r,ll rt,ll L,ll R)</span> </span>&#123;</div><div class="line">	<span class="keyword">if</span>(L&lt;=l &amp;&amp; R&gt;=r)<span class="keyword">return</span> sum[rt];</div><div class="line">	push_col(l,r,rt);</div><div class="line">	ll ret=<span class="number">0</span>;</div><div class="line">	ll m=(l+r)&gt;&gt;<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span>(L&lt;=m) ret+=query(lson,L,R);</div><div class="line">	<span class="keyword">if</span>(m&lt;R) ret+=query(rson,L,R);</div><div class="line">	<span class="keyword">return</span> ret;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">modify</span><span class="params">(ll l,ll r,ll rt,ll L,ll R,ll v)</span> </span>&#123;</div><div class="line">	<span class="keyword">if</span>(L&lt;=l &amp;&amp; R&gt;=r) &#123;</div><div class="line">		color(l,r,rt,v);</div><div class="line">		<span class="keyword">return</span> ;</div><div class="line">	&#125;</div><div class="line">	push_col(l,r,rt);</div><div class="line">	ll m=(l+r)&gt;&gt;<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span>(L&lt;=m) modify(lson,L,R,v);</div><div class="line">	<span class="keyword">if</span>(m&lt;R) modify(rson,L,R,v);</div><div class="line">	update(rt);</div><div class="line">&#125;</div><div class="line">ll n,m;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	n=read(),m=read();</div><div class="line">	<span class="keyword">for</span>(ll i=<span class="number">1</span>;i&lt;=n;i++)a[i]=read();</div><div class="line">	build(<span class="number">1</span>,n,<span class="number">1</span>);</div><div class="line">	<span class="keyword">while</span>(m--) &#123;</div><div class="line">		ll id=read();</div><div class="line">		<span class="keyword">if</span>(id==<span class="number">2</span>) &#123;</div><div class="line">			ll x=read(),y=read();</div><div class="line">			<span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,query(<span class="number">1</span>,n,<span class="number">1</span>,x,y));</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">else</span> &#123;</div><div class="line">			ll x=read(),y=read(),z=read();</div><div class="line">			modify(<span class="number">1</span>,n,<span class="number">1</span>,x,y,z);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li><h4 id="题目描述-13"><a href="#题目描述-13" class="headerlink" title="题目描述"></a>题目描述</h4><p>如题，已知一个数列，你需要进行下面两种操作：<br>1.将某区间每一个数加上x<br>2.将某区间每一个数乘上x<br>3.求出某区间每一个数的和</p>
</li>
<li><h4 id="输入输出格式-13"><a href="#输入输出格式-13" class="headerlink" title="输入输出格式"></a>输入输出格式</h4></li>
</ul>
<p><strong>输入格式：</strong></p>
<blockquote>
<p>第一行包含三个整数N、M、P，分别表示该数列数字的个数、操作的总个数和模数。<br>第二行包含N个用空格分隔的整数，其中第i个数字表示数列第i项的初始值。<br>接下来M行每行包含3或4个整数，表示一个操作，具体如下：<br>操作1： 格式：1 x y k 含义：将区间[x,y]内每个数乘上k<br>操作2： 格式：2 x y k 含义：将区间[x,y]内每个数加上k<br>操作3： 格式：3 x y 含义：输出区间[x,y]内每个数的和对P取模所得的结果</p>
</blockquote>
<p><strong>输出格式：</strong></p>
<blockquote>
<p>输出包含若干行整数，即为所有操作3的结果。</p>
<ul>
<li><h4 id="输入输出样例-13"><a href="#输入输出样例-13" class="headerlink" title="输入输出样例"></a>输入输出样例</h4></li>
</ul>
</blockquote>
<p><strong>输入样例#1：</strong></p>
<blockquote>
<p>5 5 38<br>1 5 4 2 3<br>2 1 4 1<br>3 2 5<br>1 2 4 2<br>2 3 5 5<br>3 1 4</p>
</blockquote>
<p><strong>输出样例#1：</strong></p>
<blockquote>
<p>17<br>2</p>
</blockquote>
<ul>
<li><h4 id="说明-13"><a href="#说明-13" class="headerlink" title="说明"></a>说明</h4>时空限制：1000ms,128M<br>数据规模：<br>对于30%的数据：N&lt;=8，M&lt;=10<br>对于70%的数据：N&lt;=1000，M&lt;=10000<br>对于100%的数据：N&lt;=100000，M&lt;=100000<br>（数据已经过加强^_^）<br>样例说明：<br><img src="http://upload-images.jianshu.io/upload_images/8471136-f58fc6d668b73b60.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"><br>故输出应为17、2（40 mod 38=2）</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">long</span> <span class="keyword">long</span> maxn=<span class="number">1000000</span>*<span class="number">4</span>+<span class="number">10</span>;</div><div class="line"><span class="keyword">long</span> <span class="keyword">long</span> sum[maxn],add[maxn],mul[maxn];</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> root 1,n,1</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ls l,m,o&lt;&lt;1</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> rs m+1,r,o&lt;&lt;1|1</span></div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">read</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span>&amp; x)</span> </span>&#123;</div><div class="line">	<span class="keyword">char</span> c=getchar();</div><div class="line">	<span class="keyword">long</span> <span class="keyword">long</span> p=<span class="number">1</span>,n=<span class="number">0</span>;</div><div class="line">	<span class="keyword">while</span>(c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>) &#123;</div><div class="line">		<span class="keyword">if</span>(c==<span class="string">'-'</span>)p=<span class="number">-1</span>;</div><div class="line">		c=getchar();</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">while</span>(c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>) &#123;</div><div class="line">		n=n*<span class="number">10</span>+c-<span class="string">'0'</span>;</div><div class="line">		c=getchar();</div><div class="line">	&#125;</div><div class="line">	x=p*n;</div><div class="line">&#125;</div><div class="line"><span class="keyword">long</span> <span class="keyword">long</span> ql,qr,val;</div><div class="line"><span class="keyword">long</span> <span class="keyword">long</span> n,m,MOD;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pushup</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> o)</span> </span>&#123;</div><div class="line">	sum[o]=(sum[o&lt;&lt;<span class="number">1</span>]+sum[o&lt;&lt;<span class="number">1</span>|<span class="number">1</span>])%MOD;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pushdown</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> o,<span class="keyword">long</span> <span class="keyword">long</span> m)</span> </span>&#123;</div><div class="line">	<span class="keyword">if</span>(add[o]||mul[o]!=<span class="number">1</span>) &#123;</div><div class="line">		<span class="keyword">long</span> <span class="keyword">long</span> ad=add[o],mu=mul[o];</div><div class="line">		sum[o&lt;&lt;<span class="number">1</span>]=(sum[o&lt;&lt;<span class="number">1</span>]*mu+ad*(m-(m&gt;&gt;<span class="number">1</span>)))%MOD;</div><div class="line">		sum[o&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]=(sum[o&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]*mu+ad*(m&gt;&gt;<span class="number">1</span>))%MOD;</div><div class="line">		add[o&lt;&lt;<span class="number">1</span>]=(add[o&lt;&lt;<span class="number">1</span>]*mu+ad)%MOD;</div><div class="line">		add[o&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]=(add[o&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]*mu+ad)%MOD;</div><div class="line">		mul[o&lt;&lt;<span class="number">1</span>]=(mul[o&lt;&lt;<span class="number">1</span>]*mu)%MOD;</div><div class="line">		mul[o&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]=(mul[o&lt;&lt;<span class="number">1</span>|<span class="number">1</span>]*mu)%MOD;</div><div class="line">		add[o]=<span class="number">0</span>;</div><div class="line">		mul[o]=<span class="number">1</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">build</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> l,<span class="keyword">long</span> <span class="keyword">long</span> r,<span class="keyword">long</span> <span class="keyword">long</span> o)</span> </span>&#123;</div><div class="line">	add[o]=<span class="number">0</span>;</div><div class="line">	mul[o]=<span class="number">1</span>;</div><div class="line">	<span class="keyword">if</span>(l==r) &#123;</div><div class="line">		read(sum[o]);</div><div class="line">		sum[o]=sum[o]%MOD;</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">long</span> <span class="keyword">long</span> m=l+(r-l)/<span class="number">2</span>;</div><div class="line">	build(ls);</div><div class="line">	build(rs);</div><div class="line">	pushup(o);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">update_plus</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> l,<span class="keyword">long</span> <span class="keyword">long</span> r,<span class="keyword">long</span> <span class="keyword">long</span> o)</span> </span>&#123;</div><div class="line">	pushdown(o,r-l+<span class="number">1</span>);</div><div class="line">	<span class="keyword">if</span>(ql&lt;=l&amp;&amp;r&lt;=qr) &#123;</div><div class="line">		add[o]+=val;</div><div class="line">		add[o]=add[o]%MOD;</div><div class="line">		sum[o]+=(r-l+<span class="number">1</span>)*val;</div><div class="line">		sum[o]=sum[o]%MOD;</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">long</span> <span class="keyword">long</span> m=l+(r-l)/<span class="number">2</span>;</div><div class="line">	<span class="keyword">if</span>(ql&lt;=m)update_plus(ls);</div><div class="line">	<span class="keyword">if</span>(qr&gt;m)update_plus(rs);</div><div class="line">	pushup(o);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">update_mul</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> l,<span class="keyword">long</span> <span class="keyword">long</span> r,<span class="keyword">long</span> <span class="keyword">long</span> o)</span> </span>&#123;</div><div class="line">	pushdown(o,r-l+<span class="number">1</span>);</div><div class="line">	<span class="keyword">if</span>(ql&lt;=l&amp;&amp;r&lt;=qr) &#123;</div><div class="line">		mul[o]=mul[o]*val;</div><div class="line">		mul[o]=mul[o]%MOD;</div><div class="line">		sum[o]=sum[o]*val;</div><div class="line">		sum[o]=sum[o]%MOD;</div><div class="line">		<span class="keyword">return</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">long</span> <span class="keyword">long</span> m=l+(r-l)/<span class="number">2</span>;</div><div class="line">	<span class="keyword">if</span>(ql&lt;=m)update_mul(ls);</div><div class="line">	<span class="keyword">if</span>(qr&gt;m)update_mul(rs);</div><div class="line">	pushup(o);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">query</span><span class="params">(<span class="keyword">long</span> <span class="keyword">long</span> l,<span class="keyword">long</span> <span class="keyword">long</span> r,<span class="keyword">long</span> <span class="keyword">long</span> o)</span> </span>&#123;</div><div class="line">	pushdown(o,r-l+<span class="number">1</span>);</div><div class="line">	<span class="keyword">if</span>(ql&lt;=l&amp;&amp;r&lt;=qr) &#123;</div><div class="line">		<span class="keyword">return</span> sum[o];</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">long</span> <span class="keyword">long</span> m=l+(r-l)/<span class="number">2</span>;</div><div class="line">	<span class="keyword">long</span> <span class="keyword">long</span> ret=<span class="number">0</span>;</div><div class="line">	<span class="keyword">if</span>(ql&lt;=m)ret+=query(ls),ret=ret%MOD;</div><div class="line">	<span class="keyword">if</span>(qr&gt;m)ret+=query(rs),ret=ret%MOD;</div><div class="line">	<span class="keyword">return</span> ret%MOD;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	read(n);</div><div class="line">	read(m);</div><div class="line">	read(MOD);</div><div class="line">	build(root);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">long</span> <span class="keyword">long</span> i=<span class="number">1</span>; i&lt;=m; i++) &#123;</div><div class="line">		<span class="keyword">long</span> <span class="keyword">long</span> op;</div><div class="line">		read(op);</div><div class="line">		<span class="keyword">if</span>(op==<span class="number">1</span>) &#123;</div><div class="line">			read(ql);</div><div class="line">			read(qr);</div><div class="line">			read(val);</div><div class="line">			update_mul(root);</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span>(op==<span class="number">2</span>) &#123;</div><div class="line">			read(ql);</div><div class="line">			read(qr);</div><div class="line">			read(val);</div><div class="line">			update_plus(root);</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">if</span>(op==<span class="number">3</span>) &#123;</div><div class="line">			read(ql);</div><div class="line">			read(qr);</div><div class="line">			<span class="built_in">printf</span>(<span class="string">"%lld\n"</span>,query(root)%MOD);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="ST表"><a href="#ST表" class="headerlink" title="ST表"></a>ST表</h2><ul>
<li><h4 id="题目背景-3"><a href="#题目背景-3" class="headerlink" title="题目背景"></a>题目背景</h4><p>这是一道ST表经典题——静态区间最大值<br><strong>请注意最大数据时限只有0.8s，数据强度不低，请务必保证你的每次查询复杂度为O（1）</strong> </p>
</li>
<li><h4 id="题目描述-14"><a href="#题目描述-14" class="headerlink" title="题目描述"></a>题目描述</h4><p>给定一个长度为N的数列，和M次询问，求出每一次询问的区间内数字的最大值。</p>
</li>
<li><h4 id="输入输出格式-14"><a href="#输入输出格式-14" class="headerlink" title="输入输出格式"></a>输入输出格式</h4></li>
</ul>
<p><strong>输入格式：</strong></p>
<blockquote>
<p>第一行包含两个整数N,M，分别表示数列的长度和询问的个数。第二行包含N<br>个整数（记为ai​ ），依次表示数列的第i项。<br>接下来M 行，每行包含两个整数li​,ri​ ，表示查询的区间为[li​,ri​]</p>
</blockquote>
<p><strong>输出格式：</strong></p>
<blockquote>
<p>输出包含M 行，每行一个整数，依次表示每一次询问的结果。</p>
</blockquote>
<h2 id="输入输出样例-14"><a href="#输入输出样例-14" class="headerlink" title="输入输出样例"></a>输入输出样例</h2><p><strong>输入样例#1：</strong></p>
<blockquote>
<p>8 8<br>9 3 1 7 5 6 0 8<br>1 6<br>1 5<br>2 7<br>2 6<br>1 8<br>4 8<br>3 7<br>1 8</p>
</blockquote>
<p><strong>输出样例#1：</strong></p>
<blockquote>
<p>9<br>9<br>7<br>7<br>9<br>8<br>7<br>9</p>
</blockquote>
<ul>
<li><h4 id="说明-14"><a href="#说明-14" class="headerlink" title="说明"></a>说明</h4><img src="http://upload-images.jianshu.io/upload_images/8471136-48c72d5145271757.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 1000005</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> x=<span class="number">0</span>,f=<span class="number">1</span>;<span class="keyword">char</span> ch=getchar();</div><div class="line">    <span class="keyword">while</span>(ch&lt;<span class="string">'0'</span> || ch&gt;<span class="string">'9'</span>) &#123;<span class="keyword">if</span>(ch==<span class="string">'-'</span>)f=<span class="number">-1</span>;ch=getchar();&#125;</div><div class="line">    <span class="keyword">while</span>(ch&gt;=<span class="string">'0'</span> &amp;&amp; ch&lt;=<span class="string">'9'</span>) &#123;x=x*<span class="number">10</span>+ch-<span class="string">'0'</span>;ch=getchar();&#125;</div><div class="line">    <span class="keyword">return</span> x*f;</div><div class="line">&#125;</div><div class="line"><span class="keyword">int</span> n,m;</div><div class="line"><span class="keyword">int</span> st[MAXN][<span class="number">30</span>],a[MAXN],log_2[MAXN];</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">ini_st</span><span class="params">()</span> </span>&#123;</div><div class="line">    log_2[<span class="number">1</span>]=<span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;++i) &#123;</div><div class="line">        log_2[i]=log_2[i<span class="number">-1</span>];</div><div class="line">        <span class="keyword">if</span>((<span class="number">1</span>&lt;&lt;log_2[i]+<span class="number">1</span>)==i)</div><div class="line">            ++log_2[i];</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=n;i;--i) &#123;</div><div class="line">        st[i][<span class="number">0</span>]=a[i];</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;(i+(<span class="number">1</span>&lt;&lt;j)<span class="number">-1</span>)&lt;=n;++j)</div><div class="line">            st[i][j]=max(st[i][j<span class="number">-1</span>],st[i+(<span class="number">1</span>&lt;&lt;j<span class="number">-1</span>)][j<span class="number">-1</span>]);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">ask</span><span class="params">(<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> k=log_2[r-l+<span class="number">1</span>];</div><div class="line">    <span class="keyword">return</span> max(st[l][k],st[r-(<span class="number">1</span>&lt;&lt;k)+<span class="number">1</span>][k]);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    n=read(),m=read();</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) a[i]=read();</div><div class="line">    ini_st();</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++) &#123;</div><div class="line">        <span class="keyword">int</span> l=read(),r=read();</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,ask(l,r));</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="矩阵快速幂"><a href="#矩阵快速幂" class="headerlink" title="矩阵快速幂"></a>矩阵快速幂</h2><ul>
<li><h4 id="题目背景-4"><a href="#题目背景-4" class="headerlink" title="题目背景"></a>题目背景</h4><p>矩阵快速幂</p>
</li>
<li><h4 id="题目描述-15"><a href="#题目描述-15" class="headerlink" title="题目描述"></a>题目描述</h4><p>给定n*n的矩阵A，求A^k</p>
</li>
<li><h4 id="输入输出格式-15"><a href="#输入输出格式-15" class="headerlink" title="输入输出格式"></a>输入输出格式</h4></li>
</ul>
<p><strong>输入格式：</strong></p>
<blockquote>
<p>第一行，n,k<br>第2至n+1行，每行n个数，第i+1行第j个数表示矩阵第i行第j列的元素</p>
</blockquote>
<p><strong>输出格式：</strong></p>
<blockquote>
<p>输出A^k<br>共n行，每行n个数，第i行第j个数表示矩阵第i行第j列的元素，每个元素模10^9+7</p>
</blockquote>
<ul>
<li><h4 id="输入输出样例-15"><a href="#输入输出样例-15" class="headerlink" title="输入输出样例"></a>输入输出样例</h4></li>
</ul>
<p><strong>输入样例#1：</strong></p>
<blockquote>
<p>2 1<br>1 1<br>1 1</p>
</blockquote>
<p><strong>输出样例#1：</strong></p>
<blockquote>
<p>1 1<br>1 1</p>
</blockquote>
<ul>
<li><h4 id="说明-15"><a href="#说明-15" class="headerlink" title="说明"></a>说明</h4>n&lt;=100, k&lt;=10^12, |矩阵元素|&lt;=1000 算法：矩阵快速幂</li>
</ul>
<p><strong>普通快速幂同理</strong><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ll long long</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> maxn 100+5</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> mod 1000000007</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line">ll n,m;</div><div class="line"><span class="keyword">struct</span> Matrix &#123;</div><div class="line">	ll a[maxn][maxn];</div><div class="line">	<span class="function"><span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="built_in">memset</span>(a,<span class="number">0</span>,<span class="keyword">sizeof</span>(a));</div><div class="line">	&#125;</div><div class="line">	Matrix() &#123;</div><div class="line">		<span class="keyword">this</span>-&gt;clear();</div><div class="line">	&#125;</div><div class="line">	Matrix <span class="keyword">operator</span> *(<span class="keyword">const</span> Matrix &amp;b)<span class="keyword">const</span> &#123;</div><div class="line">		Matrix c;</div><div class="line">		<span class="keyword">for</span>(ll i=<span class="number">0</span>; i&lt;n; i++)</div><div class="line">			<span class="keyword">for</span>(ll j=<span class="number">0</span>; j&lt;n; j++) &#123;</div><div class="line">				<span class="keyword">for</span>(ll k=<span class="number">0</span>; k&lt;n; k++) &#123;</div><div class="line">					c.a[i][j]+=a[i][k]*b.a[k][j]%mod;</div><div class="line">					c.a[i][j]%=mod;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line"></div><div class="line">		<span class="keyword">return</span> c;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;;</div><div class="line"><span class="function">Matrix <span class="title">fastm</span><span class="params">(Matrix &amp;x,ll n)</span> </span>&#123;</div><div class="line">	Matrix ret,k;</div><div class="line">	k=x;</div><div class="line">	ret=x;</div><div class="line">	n--;</div><div class="line">	<span class="keyword">for</span> (; n; n&gt;&gt;=<span class="number">1</span>,k=k*k)</div><div class="line">		<span class="keyword">if</span> (n&amp;<span class="number">1</span>) ret=ret*k;</div><div class="line">	<span class="keyword">return</span> ret;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	Matrix x;</div><div class="line">	<span class="built_in">cin</span>&gt;&gt;n&gt;&gt;m;</div><div class="line">	<span class="keyword">for</span>(ll i=<span class="number">0</span>; i&lt;n; i++)</div><div class="line">		<span class="keyword">for</span>(ll j=<span class="number">0</span>; j&lt;n; j++)</div><div class="line">			<span class="built_in">cin</span>&gt;&gt;x.a[i][j];</div><div class="line">	x=fastm(x,m);</div><div class="line">	<span class="keyword">for</span>(ll i=<span class="number">0</span>; i&lt;n; i++) &#123;</div><div class="line">		<span class="keyword">for</span>(ll j=<span class="number">0</span>; j&lt;n; j++) &#123;</div><div class="line">			<span class="built_in">cout</span>&lt;&lt;x.a[i][j]&lt;&lt;<span class="string">' '</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="built_in">cout</span>&lt;&lt;<span class="built_in">endl</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="线性筛素数"><a href="#线性筛素数" class="headerlink" title="线性筛素数"></a>线性筛素数</h2><ul>
<li><h4 id="题目描述-16"><a href="#题目描述-16" class="headerlink" title="题目描述"></a>题目描述</h4><p>如题，给定一个范围N，你需要处理M个某数字是否为质数的询问（每个数字均在范围1-N内）</p>
</li>
<li><h4 id="输入输出格式-16"><a href="#输入输出格式-16" class="headerlink" title="输入输出格式"></a>输入输出格式</h4></li>
</ul>
<p><strong>输入格式：</strong></p>
<blockquote>
<p>第一行包含两个正整数N、M，分别表示查询的范围和查询的个数。<br>接下来M行每行包含一个不小于1且不大于N的整数，即询问该数是否为质数。</p>
</blockquote>
<p><strong>输出格式：</strong></p>
<blockquote>
<p>输出包含M行，每行为Yes或No，即依次为每一个询问的结果。</p>
</blockquote>
<ul>
<li><h4 id="输入输出样例-16"><a href="#输入输出样例-16" class="headerlink" title="输入输出样例"></a>输入输出样例</h4><strong>输入样例#1：</strong><blockquote>
<p>100 5<br>2<br>3<br>4<br>91<br>97</p>
</blockquote>
</li>
</ul>
<p><strong>输出样例#1：</strong></p>
<blockquote>
<p>Yes<br>Yes<br>No<br>No<br>Yes</p>
</blockquote>
<ul>
<li><h4 id="说明-16"><a href="#说明-16" class="headerlink" title="说明"></a>说明</h4>时空限制：500ms 128M<br>数据规模：<br>对于30%的数据：N&lt;=10000，M&lt;=10000<br>对于100%的数据：N&lt;=10000000，M&lt;=100000<br>样例说明：<br>N=100，说明接下来的询问数均不大于100且不小于1。<br>所以2、3、97为质数，4、91非质数。<br>故依次输出Yes、Yes、No、No、Yes。</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">10000000</span>;</div><div class="line"><span class="keyword">int</span> prime[maxn],n,tot,m;</div><div class="line"><span class="keyword">bool</span> vis[maxn];</div><div class="line"><span class="function"><span class="keyword">bool</span> <span class="title">is_prime</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> k=<span class="built_in">sqrt</span>(x+<span class="number">0.5</span>);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>; i&lt;=k; i++)</div><div class="line">        <span class="keyword">if</span>(x%i==<span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</div><div class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Eratosthenes</span><span class="params">()</span> </span>&#123; </div><div class="line">    <span class="keyword">int</span> m=<span class="built_in">sqrt</span>(n+<span class="number">0.5</span>);</div><div class="line">    vis[<span class="number">1</span>]=<span class="literal">true</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>; i&lt;=m; i++)</div><div class="line">        <span class="keyword">if</span>(vis[i]==<span class="literal">false</span>)</div><div class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=i*i; j&lt;=n; j+=i)</div><div class="line">                vis[j]=<span class="literal">true</span>;</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">GetPrime</span><span class="params">()</span> </span>&#123; </div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>; i&lt;=n; i++) &#123;</div><div class="line">        <span class="keyword">if</span>(vis[i]==<span class="literal">false</span>) prime[++tot]=i;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>; j&lt;=tot&amp;&amp;i*prime[j]&lt;=n; j++) &#123;</div><div class="line">            vis[i*prime[j]]=<span class="literal">true</span>;</div><div class="line">            <span class="keyword">if</span>(i%prime[j]==<span class="number">0</span>) <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">()</span> </span>&#123;</div><div class="line">    GetPrime();</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=tot; i++)</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>,prime[i]);</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="built_in">cin</span>&gt;&gt;n&gt;&gt;m;</div><div class="line">    Eratosthenes();</div><div class="line">    <span class="keyword">while</span>(m--) &#123;</div><div class="line">        <span class="keyword">int</span> a;</div><div class="line">        <span class="built_in">cin</span>&gt;&gt;a;</div><div class="line">        <span class="keyword">if</span>(!vis[a]) <span class="built_in">cout</span>&lt;&lt;<span class="string">"Yes"</span>&lt;&lt;<span class="built_in">endl</span>;</div><div class="line">        <span class="keyword">else</span> <span class="built_in">cout</span>&lt;&lt;<span class="string">"No"</span>&lt;&lt;<span class="built_in">endl</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="乘法逆元"><a href="#乘法逆元" class="headerlink" title="乘法逆元"></a>乘法逆元</h2><ul>
<li><h4 id="题目背景-5"><a href="#题目背景-5" class="headerlink" title="题目背景"></a>题目背景</h4><p>这是一道模板题</p>
</li>
<li><h4 id="题目描述-17"><a href="#题目描述-17" class="headerlink" title="题目描述"></a>题目描述</h4><p>给定n,p求1~n中所有整数在模p意义下的乘法逆元。</p>
</li>
<li><h4 id="输入输出格式-17"><a href="#输入输出格式-17" class="headerlink" title="输入输出格式"></a>输入输出格式</h4></li>
</ul>
<p><strong>输入格式：</strong><br>一行n,p</p>
<p><strong>输出格式：</strong><br>n行,第i行表示i在模p意义下的逆元。</p>
<ul>
<li><h4 id="输入输出样例-17"><a href="#输入输出样例-17" class="headerlink" title="输入输出样例"></a>输入输出样例</h4></li>
</ul>
<p><strong>输入样例#1：</strong><br>10 13</p>
<p><strong>输出样例#1：</strong><br>1<br>7<br>9<br>10<br>8<br>11<br>2<br>5<br>3<br>4</p>
<ul>
<li><h4 id="说明-17"><a href="#说明-17" class="headerlink" title="说明"></a>说明</h4><img src="http://upload-images.jianshu.io/upload_images/8471136-5d361082356f0da5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></li>
</ul>
<p><strong>线性</strong><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> N 3000010</span></div><div class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> ll;</div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> inv[N],n,p;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="built_in">cin</span>&gt;&gt;n&gt;&gt;p;</div><div class="line">    inv[<span class="number">1</span>]=<span class="number">1</span>;</div><div class="line">    <span class="built_in">puts</span>(<span class="string">"1"</span>);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>; i&lt;=n; i++) &#123;</div><div class="line">        inv[i]=(ll)(p-p/i)*inv[p%i]%p;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,inv[i]);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p><strong>扩展欧几里得</strong><br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">ex_gcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b,<span class="keyword">int</span> &amp;x,<span class="keyword">int</span> &amp;y)</span> </span>&#123;  </div><div class="line">    <span class="keyword">if</span> (a==<span class="number">0</span>&amp;&amp;b==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span>;  </div><div class="line">    <span class="keyword">if</span> (b==<span class="number">0</span>)&#123;x=<span class="number">1</span>;y=<span class="number">0</span>;<span class="keyword">return</span> a;&#125;  </div><div class="line">    <span class="keyword">int</span> d=ex_gcd(b,a%b,y,x);  </div><div class="line">    y-=a/b*x;  </div><div class="line">    <span class="keyword">return</span> d;  </div><div class="line">&#125;  </div><div class="line">  </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">inv</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> n)</span> </span>&#123;  </div><div class="line">    <span class="keyword">int</span> x,y;  </div><div class="line">    <span class="keyword">int</span> d = ex_gcd(a,n,x,y);  </div><div class="line">    <span class="keyword">return</span> (x%n+n)%n;  </div><div class="line">&#125;  </div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> a,p;</div><div class="line">    <span class="built_in">scanf</span>(<span class="string">"%d%d"</span>,&amp;a,&amp;p);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=a;i++)</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,inv(i,p));</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="扩展欧几里得（EXGCD）"><a href="#扩展欧几里得（EXGCD）" class="headerlink" title="扩展欧几里得（EXGCD）"></a>扩展欧几里得（EXGCD）</h2><ul>
<li><h4 id="题目描述-18"><a href="#题目描述-18" class="headerlink" title="题目描述"></a>题目描述</h4><p>求关于 x 的同余方程 ax ≡ 1 (mod b)的最小正整数解。</p>
</li>
<li><h4 id="输入输出格式-18"><a href="#输入输出格式-18" class="headerlink" title="输入输出格式"></a>输入输出格式</h4></li>
</ul>
<p><strong>输入格式：</strong></p>
<blockquote>
<p>输入只有一行，包含两个正整数 a, b，用一个空格隔开。</p>
</blockquote>
<p><strong>输出格式：</strong></p>
<blockquote>
<p>输出只有一行，包含一个正整数 x0，即最小正整数解。输入数据保证一定有解。</p>
</blockquote>
<ul>
<li><h4 id="输入输出样例-18"><a href="#输入输出样例-18" class="headerlink" title="输入输出样例"></a>输入输出样例</h4></li>
</ul>
<p><strong>输入样例#1：</strong></p>
<blockquote>
<p>3 10</p>
</blockquote>
<p><strong>输出样例#1：</strong></p>
<blockquote>
<p>7</p>
</blockquote>
<ul>
<li><h4 id="说明-18"><a href="#说明-18" class="headerlink" title="说明"></a>说明</h4></li>
</ul>
<p>【数据范围】<br>对于 40%的数据，2 ≤b≤ 1,000；<br>对于 60%的数据，2 ≤b≤ 50,000,000；<br>对于 100%的数据，2 ≤a, b≤ 2,000,000,000。<br><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;  </span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt; </span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> a,b,x,y,k;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">exgcd</span><span class="params">(<span class="keyword">int</span> a,<span class="keyword">int</span> b)</span> </span>&#123;</div><div class="line">    <span class="keyword">if</span>(b==<span class="number">0</span>) &#123;</div><div class="line">        x=<span class="number">1</span>;</div><div class="line">        y=<span class="number">0</span>;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line">    exgcd(b,a%b);</div><div class="line">    k=x;</div><div class="line">    x=y;</div><div class="line">    y=k-a/b*y;</div><div class="line">    <span class="keyword">return</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="built_in">cin</span>&gt;&gt;a&gt;&gt;b;</div><div class="line">    exgcd(a,b);</div><div class="line">    <span class="built_in">cout</span>&lt;&lt;(x+b)%b;</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="字符串哈希"><a href="#字符串哈希" class="headerlink" title="字符串哈希"></a>字符串哈希</h2><ul>
<li><h4 id="题目描述-19"><a href="#题目描述-19" class="headerlink" title="题目描述"></a>题目描述</h4><p>如题，给定N个字符串（第i个字符串长度为Mi，字符串内包含数字、大小写字母，大小写敏感），请求出N个字符串中共有多少个不同的字符串。<br><strong>友情提醒：如果真的想好好练习哈希的话，请自觉，否则请右转PJ试炼场:)</strong></p>
</li>
<li><h4 id="输入输出格式-19"><a href="#输入输出格式-19" class="headerlink" title="输入输出格式"></a>输入输出格式</h4></li>
</ul>
<p><strong>输入格式：</strong></p>
<blockquote>
<p>第一行包含一个整数N，为字符串的个数。<br>接下来N行每行包含一个字符串，为所提供的字符串。</p>
</blockquote>
<p><strong>输出格式：</strong></p>
<blockquote>
<p>输出包含一行，包含一个整数，为不同的字符串个数。</p>
</blockquote>
<ul>
<li><h4 id="输入输出样例-19"><a href="#输入输出样例-19" class="headerlink" title="输入输出样例"></a>输入输出样例</h4></li>
</ul>
<p><strong>输入样例#1：</strong></p>
<blockquote>
<p>5<br>abc<br>aaaa<br>abc<br>abcc<br>12345</p>
</blockquote>
<p><strong>输出样例#1：</strong></p>
<blockquote>
<p>4</p>
</blockquote>
<ul>
<li><h4 id="说明-19"><a href="#说明-19" class="headerlink" title="说明"></a>说明</h4>时空限制：1000ms,128M<br>数据规模：<br>对于30%的数据：N&lt;=10，Mi≈6，Mmax&lt;=15;<br>对于70%的数据：N&lt;=1000，Mi≈100，Mmax&lt;=150<br>对于100%的数据：N&lt;=10000，Mi≈1000，Mmax&lt;=1500<br>样例说明：<br>样例中第一个字符串(abc)和第三个字符串(abc)是一样的，所以所提供字符串的集合为{aaaa,abc,abcc,12345}，故共计4个不同的字符串。<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXN 10005</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> seed 20020207</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> ULL unsigned long long</span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">int</span> n;</div><div class="line"><span class="keyword">long</span> <span class="keyword">long</span> h[MAXN];</div><div class="line"><span class="built_in">string</span> s[MAXN];</div><div class="line"><span class="function">ULL <span class="title">hash</span><span class="params">(<span class="built_in">string</span> s)</span> </span>&#123;</div><div class="line">	ULL value=<span class="number">0</span>;</div><div class="line">	<span class="keyword">int</span> x=<span class="number">1</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;s.length();i++) &#123;</div><div class="line">		value+=s[i]*x*seed;</div><div class="line">		x*=<span class="number">10</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> value;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) &#123;</div><div class="line">		<span class="built_in">cin</span>&gt;&gt;s[i];</div><div class="line">		h[i]=hash(s[i]);</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">int</span> ans=<span class="number">0</span>;</div><div class="line">	sort(h+<span class="number">1</span>,h+n+<span class="number">1</span>);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) &#123;</div><div class="line">		<span class="keyword">if</span>(h[i]!=h[i+<span class="number">1</span>]) ans++;</div><div class="line">	&#125;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d"</span>,ans);</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="KMP"><a href="#KMP" class="headerlink" title="KMP"></a>KMP</h2><ul>
<li><h4 id="题目描述-20"><a href="#题目描述-20" class="headerlink" title="题目描述"></a>题目描述</h4><p>如题，给出两个字符串s1和s2，其中s2为s1的子串，求出s2在s1中所有出现的位置。<br><strong>为了减少骗分的情况，接下来还要输出子串的前缀数组next。</strong></p>
</li>
<li><h4 id="输入输出格式-20"><a href="#输入输出格式-20" class="headerlink" title="输入输出格式"></a>输入输出格式</h4></li>
</ul>
<p><strong>输入格式：</strong></p>
<blockquote>
<p>第一行为一个字符串，即为s1<br>第二行为一个字符串，即为s2</p>
</blockquote>
<p><strong>输出格式：</strong></p>
<blockquote>
<p>若干行，每行包含一个整数，表示s2在s1中出现的位置<br>接下来1行，包括length(s2)个整数，表示前缀数组next[i]的值。</p>
</blockquote>
<ul>
<li><h4 id="输入输出样例-20"><a href="#输入输出样例-20" class="headerlink" title="输入输出样例"></a>输入输出样例</h4></li>
</ul>
<p><strong>输入样例#1：</strong></p>
<blockquote>
<p>ABABABC<br>ABA</p>
</blockquote>
<p><strong>输出样例#1：</strong><br>1<br>3<br>0 0 1 </p>
<ul>
<li><h4 id="说明-20"><a href="#说明-20" class="headerlink" title="说明"></a>说明</h4>时空限制：1000ms,128M<br>数据规模：<br>设s1长度为N，s2长度为M<br>对于30%的数据：N&lt;=15，M&lt;=5<br>对于70%的数据：N&lt;=10000，M&lt;=100<br>对于100%的数据：N&lt;=1000000，M&lt;=1000000<br>样例说明：<br><img src="http://upload-images.jianshu.io/upload_images/8471136-b58d31dac4ea2596.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image"><br>所以两个匹配位置为1和3，输出1、3</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;vector&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">const</span> <span class="keyword">int</span> maxn=<span class="number">1001</span>;</div><div class="line"><span class="keyword">int</span> Next[maxn];</div><div class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; Ans;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Get_Next</span><span class="params">(<span class="built_in">string</span> s)</span> </span>&#123;</div><div class="line">    <span class="keyword">int</span> l=s.length(),t;</div><div class="line">    Next[<span class="number">0</span>]=<span class="number">-1</span>;</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;l;++i) &#123;</div><div class="line">        t=Next[i<span class="number">-1</span>];</div><div class="line">        <span class="keyword">while</span>(s[t+<span class="number">1</span>]!=s[i]&amp;&amp;t&gt;=<span class="number">0</span>)</div><div class="line">            t=Next[t];</div><div class="line">        <span class="keyword">if</span>(s[t+<span class="number">1</span>]==s[i])</div><div class="line">            Next[i]=t+<span class="number">1</span>;</div><div class="line">        <span class="keyword">else</span></div><div class="line">            Next[i]=<span class="number">-1</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">KMP</span><span class="params">(<span class="built_in">string</span> s1,<span class="built_in">string</span> s2)</span> </span>&#123;</div><div class="line">    Get_Next(s2);</div><div class="line">    <span class="keyword">int</span> l1=s1.length();</div><div class="line">    <span class="keyword">int</span> l2=s2.length();</div><div class="line">    <span class="keyword">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>;</div><div class="line">    <span class="keyword">while</span>(j&lt;l1) &#123;</div><div class="line">        <span class="keyword">if</span>(s2[i]==s1[j]) &#123;</div><div class="line">            ++i;++j;</div><div class="line">            <span class="keyword">if</span>(i==l2) &#123;</div><div class="line">                Ans.push_back(j-l2+<span class="number">1</span>);</div><div class="line">                i=Next[i<span class="number">-1</span>]+<span class="number">1</span>;               </div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">if</span>(i==<span class="number">0</span>)</div><div class="line">                j++;</div><div class="line">            <span class="keyword">else</span></div><div class="line">                i=Next[i<span class="number">-1</span>]+<span class="number">1</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">    <span class="built_in">string</span> s1,s2;</div><div class="line">    <span class="keyword">int</span> l;</div><div class="line">    <span class="built_in">cin</span>&gt;&gt;s1&gt;&gt;s2;</div><div class="line">    l=s2.length();</div><div class="line">    KMP(s1,s2);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;Ans.size();++i)</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d\n"</span>,Ans[i]);</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;l;++i)</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>,Next[i]+<span class="number">1</span>);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="AC自动机"><a href="#AC自动机" class="headerlink" title="AC自动机"></a>AC自动机</h2><ul>
<li><h4 id="题目背景-6"><a href="#题目背景-6" class="headerlink" title="题目背景"></a>题目背景</h4><p>这是一道简单的AC自动机模板题。<br>用于检测正确性以及算法常数。<br><strong>管理员提示：本题数据内有重复的单词，且重复单词应该计算多次，请各位注意</strong></p>
</li>
<li><h4 id="题目描述-21"><a href="#题目描述-21" class="headerlink" title="题目描述"></a>题目描述</h4><p>给定n个模式串和1个文本串，求有多少个模式串在文本串里出现过。</p>
</li>
<li><h4 id="输入输出格式-21"><a href="#输入输出格式-21" class="headerlink" title="输入输出格式"></a>输入输出格式</h4></li>
</ul>
<p><strong>输入格式：</strong></p>
<blockquote>
<p>第一行一个n，表示模式串个数；<br>下面n行每行一个模式串；<br>下面一行一个文本串。</p>
</blockquote>
<p><strong>输出格式：</strong></p>
<blockquote>
<p>一个数表示答案</p>
</blockquote>
<ul>
<li><h4 id="输入输出样例-21"><a href="#输入输出样例-21" class="headerlink" title="输入输出样例"></a>输入输出样例</h4></li>
</ul>
<p><strong>输入样例#1：</strong></p>
<blockquote>
<p>2<br>a<br>aa<br>aa</p>
</blockquote>
<p><strong>输出样例#1：</strong></p>
<blockquote>
<p>2</p>
</blockquote>
<ul>
<li><h4 id="说明-21"><a href="#说明-21" class="headerlink" title="说明"></a>说明</h4>subtask1[50pts]:∑length(模式串)&lt;=10^6,length(文本串)&lt;=10^6,n=1；<br>subtask2[50pts]:∑length(模式串)&lt;=10^6,length(文本串)&lt;=10^6；</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">struct</span> Trie &#123;</div><div class="line">	<span class="keyword">int</span> ch[<span class="number">26</span>];</div><div class="line">	<span class="keyword">int</span> end;</div><div class="line">	<span class="keyword">int</span> fail;</div><div class="line">&#125;AC[<span class="number">1000000</span>];</div><div class="line"><span class="keyword">int</span> cnt=<span class="number">0</span>;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">index</span><span class="params">(<span class="keyword">char</span> c)</span> </span>&#123;</div><div class="line">	<span class="keyword">return</span> c-<span class="string">'a'</span>;</div><div class="line">&#125; </div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Build_Trie</span><span class="params">(<span class="built_in">string</span> s)</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> l=s.length();</div><div class="line">	<span class="keyword">int</span> now=<span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;l;i++) &#123;</div><div class="line">		<span class="keyword">int</span> id=index(s[i]);</div><div class="line">		<span class="keyword">if</span>(AC[now].ch[id]==<span class="number">0</span>) &#123;</div><div class="line">			AC[now].ch[id]=++cnt;</div><div class="line">		&#125;</div><div class="line">		now=AC[now].ch[id];</div><div class="line">	&#125;</div><div class="line">	AC[now].end++;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Get_fail</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">26</span>;i++) &#123;</div><div class="line">		<span class="keyword">if</span>(AC[<span class="number">0</span>].ch[i]!=<span class="number">0</span>) &#123;</div><div class="line">			AC[AC[<span class="number">0</span>].ch[i]].fail=<span class="number">0</span>;</div><div class="line">			q.push(AC[<span class="number">0</span>].ch[i]);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">while</span>(!q.empty()) &#123;</div><div class="line">		<span class="keyword">int</span> u=q.front();</div><div class="line">		q.pop();</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">26</span>;i++) &#123;</div><div class="line">			<span class="keyword">if</span>(AC[u].ch[i]!=<span class="number">0</span>) &#123;</div><div class="line">				AC[AC[u].ch[i]].fail=AC[AC[u].fail].ch[i];</div><div class="line">				q.push(AC[u].ch[i]);</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">else</span> </div><div class="line">			  AC[u].ch[i]=AC[AC[u].fail].ch[i];</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">AC_work</span><span class="params">(<span class="built_in">string</span> s)</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> l=s.length();</div><div class="line">	<span class="keyword">int</span> now=<span class="number">0</span>,ans=<span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;l;i++) &#123;</div><div class="line">		now=AC[now].ch[index(s[i])];</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=now;j &amp;&amp; AC[j].end!=<span class="number">-1</span>;j=AC[j].fail) &#123;</div><div class="line">			ans+=AC[j].end;</div><div class="line">			AC[j].end=<span class="number">-1</span>;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> n;</div><div class="line">	<span class="built_in">string</span> s;</div><div class="line">	<span class="built_in">scanf</span>(<span class="string">"%d"</span>,&amp;n);</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++) &#123;</div><div class="line">		<span class="built_in">cin</span>&gt;&gt;s;</div><div class="line">		Build_Trie(s);</div><div class="line">	&#125;</div><div class="line">	Get_fail();</div><div class="line">	<span class="built_in">cin</span>&gt;&gt;s;</div><div class="line">	<span class="built_in">printf</span>(<span class="string">"%d"</span>,AC_work(s));</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li><h4 id="题目描述-22"><a href="#题目描述-22" class="headerlink" title="题目描述"></a>题目描述</h4><p>有N个由小写字母组成的模式串以及一个文本串 T 。每个模式串可能会在文本串中出现多次。你需要找出<strong>哪些</strong>模式串在文本串 T 中出现的次数最多。</p>
</li>
<li><h4 id="输入输出格式-22"><a href="#输入输出格式-22" class="headerlink" title="输入输出格式"></a>输入输出格式</h4></li>
</ul>
<p><strong>输入格式：</strong></p>
<blockquote>
<p>输入含多组数据。<br>每组数据的第一行为一个正整数 N ，表示共有 N 个模式串， 1≤N≤150 。接下去 N 行，每行一个长度小于等于 70 的模式串。下一行是一个长度小于等于 106 的文本串 T 。<br>输入结束标志为 N=0 。</p>
</blockquote>
<p><strong>输出格式：</strong></p>
<blockquote>
<p>对于每组数据，第一行输出模式串最多出现的次数，接下去若干行每行输出一个出现次数最多的模式串，按输入顺序排列。</p>
</blockquote>
<ul>
<li><h4 id="输入输出样例-22"><a href="#输入输出样例-22" class="headerlink" title="输入输出样例"></a>输入输出样例</h4></li>
</ul>
<p><strong>输入样例#1：</strong></p>
<blockquote>
<p>2<br>aba<br>bab<br>ababababac<br>6<br>beta<br>alpha<br>haha<br>delta<br>dede<br>tata<br>dedeltalphahahahototatalpha<br>0</p>
</blockquote>
<p><strong>输出样例#1：</strong></p>
<blockquote>
<p>4<br>aba<br>2<br>alpha<br>haha</p>
</blockquote>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;queue&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;algorithm&gt;</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">struct</span> Tree &#123;</div><div class="line">	<span class="keyword">int</span> fail;</div><div class="line">	<span class="keyword">int</span> vis[<span class="number">26</span>];</div><div class="line">	<span class="keyword">int</span> end;</div><div class="line">&#125; AC[<span class="number">100000</span>];</div><div class="line"><span class="keyword">int</span> cnt;</div><div class="line"><span class="keyword">struct</span> Result &#123;</div><div class="line">	<span class="keyword">int</span> num;</div><div class="line">	<span class="keyword">int</span> pos;</div><div class="line">&#125; Ans[<span class="number">100000</span>];</div><div class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &lt;(Result a,Result b) &#123;</div><div class="line">	<span class="keyword">if</span>(a.num!=b.num)</div><div class="line">		<span class="keyword">return</span> a.num&gt;b.num;</div><div class="line">	<span class="keyword">else</span></div><div class="line">		<span class="keyword">return</span> a.pos&lt;b.pos;</div><div class="line">&#125;</div><div class="line"><span class="built_in">string</span> s[<span class="number">100000</span>];</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Clean</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</div><div class="line">	<span class="built_in">memset</span>(AC[x].vis,<span class="number">0</span>,<span class="keyword">sizeof</span>(AC[x].vis));</div><div class="line">	AC[x].fail=<span class="number">0</span>;</div><div class="line">	AC[x].end=<span class="number">0</span>;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Build</span><span class="params">(<span class="built_in">string</span> s,<span class="keyword">int</span> Num)</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> l=s.length();</div><div class="line">	<span class="keyword">int</span> now=<span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;l; ++i) &#123;</div><div class="line">		<span class="keyword">if</span>(AC[now].vis[s[i]-<span class="string">'a'</span>]==<span class="number">0</span>) &#123;</div><div class="line">			AC[now].vis[s[i]-<span class="string">'a'</span>]=++cnt;</div><div class="line">			Clean(cnt);</div><div class="line">		&#125;</div><div class="line">		now=AC[now].vis[s[i]-<span class="string">'a'</span>];</div><div class="line">	&#125;</div><div class="line">	AC[now].end=Num;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">void</span> <span class="title">Get_fail</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; Q;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">26</span>; ++i) &#123;</div><div class="line">		<span class="keyword">if</span>(AC[<span class="number">0</span>].vis[i]!=<span class="number">0</span>) &#123;</div><div class="line">			AC[AC[<span class="number">0</span>].vis[i]].fail=<span class="number">0</span>;</div><div class="line">			Q.push(AC[<span class="number">0</span>].vis[i]);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">while</span>(!Q.empty()) &#123;</div><div class="line">		<span class="keyword">int</span> u=Q.front();</div><div class="line">		Q.pop();</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">26</span>; ++i) &#123;</div><div class="line">			<span class="keyword">if</span>(AC[u].vis[i]!=<span class="number">0</span>) &#123;</div><div class="line">				AC[AC[u].vis[i]].fail=AC[AC[u].fail].vis[i];</div><div class="line">				Q.push(AC[u].vis[i]);</div><div class="line">			&#125; <span class="keyword">else</span></div><div class="line">				AC[u].vis[i]=AC[AC[u].fail].vis[i];</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">AC_Query</span><span class="params">(<span class="built_in">string</span> s)</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> l=s.length();</div><div class="line">	<span class="keyword">int</span> now=<span class="number">0</span>,ans=<span class="number">0</span>;</div><div class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;l; ++i) &#123;</div><div class="line">		now=AC[now].vis[s[i]-<span class="string">'a'</span>];</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> t=now; t; t=AC[t].fail)</div><div class="line">			Ans[AC[t].end].num++;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</div><div class="line">	<span class="keyword">int</span> n;</div><div class="line">	<span class="keyword">while</span>(<span class="number">233</span>) &#123;</div><div class="line">		<span class="built_in">cin</span>&gt;&gt;n;</div><div class="line">		<span class="keyword">if</span>(n==<span class="number">0</span>)<span class="keyword">break</span>;</div><div class="line">		cnt=<span class="number">0</span>;</div><div class="line">		Clean(<span class="number">0</span>);</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; ++i) &#123;</div><div class="line">			<span class="built_in">cin</span>&gt;&gt;s[i];</div><div class="line">			Ans[i].num=<span class="number">0</span>;</div><div class="line">			Ans[i].pos=i;</div><div class="line">			Build(s[i],i);</div><div class="line">		&#125;</div><div class="line">		AC[<span class="number">0</span>].fail=<span class="number">0</span>;</div><div class="line">		Get_fail();</div><div class="line">		<span class="built_in">cin</span>&gt;&gt;s[<span class="number">0</span>];</div><div class="line">		AC_Query(s[<span class="number">0</span>]);</div><div class="line">		sort(&amp;Ans[<span class="number">1</span>],&amp;Ans[n+<span class="number">1</span>]);</div><div class="line">		<span class="built_in">cout</span>&lt;&lt;Ans[<span class="number">1</span>].num&lt;&lt;<span class="built_in">endl</span>;</div><div class="line">		<span class="built_in">cout</span>&lt;&lt;s[Ans[<span class="number">1</span>].pos]&lt;&lt;<span class="built_in">endl</span>;</div><div class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>; i&lt;=n; ++i) &#123;</div><div class="line">			<span class="keyword">if</span>(Ans[i].num==Ans[i<span class="number">-1</span>].num)</div><div class="line">				<span class="built_in">cout</span>&lt;&lt;s[Ans[i].pos]&lt;&lt;<span class="built_in">endl</span>;</div><div class="line">			<span class="keyword">else</span> <span class="keyword">break</span>;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="高精度"><a href="#高精度" class="headerlink" title="高精度"></a>高精度</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iosfwd&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cmath&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdlib&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstdio&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;cstring&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAX_L 2005 <span class="comment">//最大长度，可以修改</span></span></div><div class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</div><div class="line"><span class="keyword">class</span> BN &#123;</div><div class="line">    <span class="keyword">public</span>:</div><div class="line">        <span class="keyword">int</span> len, s[MAX_L];<span class="comment">//数的长度，记录数组</span></div><div class="line"><span class="comment">//构造函数</span></div><div class="line">        BN();</div><div class="line">        BN(<span class="keyword">const</span> <span class="keyword">char</span>*);</div><div class="line">        BN(<span class="keyword">int</span>);</div><div class="line">        <span class="keyword">bool</span> sign;<span class="comment">//符号 1正数 0负数</span></div><div class="line">        <span class="function"><span class="built_in">string</span> <span class="title">toStr</span><span class="params">()</span> <span class="keyword">const</span></span>;<span class="comment">//转化为字符串，主要是便于输出</span></div><div class="line">        <span class="keyword">friend</span> istream&amp; <span class="keyword">operator</span>&gt;&gt;(istream &amp;,BN &amp;);<span class="comment">//重载输入流</span></div><div class="line">        <span class="keyword">friend</span> ostream&amp; <span class="keyword">operator</span>&lt;&lt;(ostream &amp;,BN &amp;);<span class="comment">//重载输出流</span></div><div class="line"><span class="comment">//重载复制</span></div><div class="line">        BN <span class="keyword">operator</span>=(<span class="keyword">const</span> <span class="keyword">char</span>*);</div><div class="line">        BN <span class="keyword">operator</span>=(<span class="keyword">int</span>);</div><div class="line">        BN <span class="keyword">operator</span>=(<span class="keyword">const</span> <span class="built_in">string</span>);</div><div class="line"><span class="comment">//重载各种比较</span></div><div class="line">        <span class="keyword">bool</span> <span class="keyword">operator</span>&gt;(<span class="keyword">const</span> BN &amp;) <span class="keyword">const</span>;</div><div class="line">        <span class="keyword">bool</span> <span class="keyword">operator</span>&gt;=(<span class="keyword">const</span> BN &amp;) <span class="keyword">const</span>;</div><div class="line">        <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;(<span class="keyword">const</span> BN &amp;) <span class="keyword">const</span>;</div><div class="line">        <span class="keyword">bool</span> <span class="keyword">operator</span>&lt;=(<span class="keyword">const</span> BN &amp;) <span class="keyword">const</span>;</div><div class="line">        <span class="keyword">bool</span> <span class="keyword">operator</span>==(<span class="keyword">const</span> BN &amp;) <span class="keyword">const</span>;</div><div class="line">        <span class="keyword">bool</span> <span class="keyword">operator</span>!=(<span class="keyword">const</span> BN &amp;) <span class="keyword">const</span>;</div><div class="line"><span class="comment">//重载四则运算</span></div><div class="line">        BN <span class="keyword">operator</span>+(<span class="keyword">const</span> BN &amp;) <span class="keyword">const</span>;</div><div class="line">        BN <span class="keyword">operator</span>++();</div><div class="line">        BN <span class="keyword">operator</span>++(<span class="keyword">int</span>);</div><div class="line">        BN <span class="keyword">operator</span>+=(<span class="keyword">const</span> BN&amp;);</div><div class="line">        BN <span class="keyword">operator</span>-(<span class="keyword">const</span> BN &amp;) <span class="keyword">const</span>;</div><div class="line">        BN <span class="keyword">operator</span>--();</div><div class="line">        BN <span class="keyword">operator</span>--(<span class="keyword">int</span>);</div><div class="line">        BN <span class="keyword">operator</span>-=(<span class="keyword">const</span> BN&amp;);</div><div class="line">        BN <span class="keyword">operator</span>*(<span class="keyword">const</span> BN &amp;)<span class="keyword">const</span>;</div><div class="line">        BN <span class="keyword">operator</span>*(<span class="keyword">const</span> <span class="keyword">int</span> num)<span class="keyword">const</span>;</div><div class="line">        BN <span class="keyword">operator</span>*=(<span class="keyword">const</span> BN&amp;);</div><div class="line">        BN <span class="keyword">operator</span>/(<span class="keyword">const</span> BN&amp;)<span class="keyword">const</span>;</div><div class="line">        BN <span class="keyword">operator</span>/=(<span class="keyword">const</span> BN&amp;);</div><div class="line"><span class="comment">//四则运算的衍生运算</span></div><div class="line">        BN <span class="keyword">operator</span>%(<span class="keyword">const</span> BN&amp;)<span class="keyword">const</span>;<span class="comment">//取模（余数）</span></div><div class="line">        <span class="function">BN <span class="title">factorial</span><span class="params">()</span><span class="keyword">const</span></span>;<span class="comment">//阶乘</span></div><div class="line">        <span class="function">BN <span class="title">Sqrt</span><span class="params">()</span><span class="keyword">const</span></span>;<span class="comment">//整数开根（向下取整）</span></div><div class="line">        <span class="function">BN <span class="title">pow</span><span class="params">(<span class="keyword">const</span> BN&amp;)</span><span class="keyword">const</span></span>;<span class="comment">//次方</span></div><div class="line"><span class="comment">//一些乱乱的函数</span></div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">clean</span><span class="params">()</span></span>;</div><div class="line">        ~BN();</div><div class="line">&#125;;</div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> max(a,b) a&gt;b ? a : b</span></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> min(a,b) a&lt;b ? a : b</span></div><div class="line">BN::BN() &#123;</div><div class="line">    <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="keyword">sizeof</span>(s));</div><div class="line">    len = <span class="number">1</span>;</div><div class="line">    sign = <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line">BN::BN(<span class="keyword">const</span> <span class="keyword">char</span> *num) &#123;</div><div class="line">    *<span class="keyword">this</span> = num;</div><div class="line">&#125;</div><div class="line">BN::BN(<span class="keyword">int</span> num) &#123;</div><div class="line">    *<span class="keyword">this</span> = num;</div><div class="line">&#125;</div><div class="line"><span class="built_in">string</span> BN::toStr() <span class="keyword">const</span> &#123;</div><div class="line">    <span class="built_in">string</span> res;</div><div class="line">    res = <span class="string">""</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++)</div><div class="line">        res = (<span class="keyword">char</span>)(s[i] + <span class="string">'0'</span>) + res;</div><div class="line">    <span class="keyword">if</span> (res == <span class="string">""</span>)</div><div class="line">        res = <span class="string">"0"</span>;</div><div class="line">    <span class="keyword">if</span> (!sign&amp;&amp;res != <span class="string">"0"</span>)</div><div class="line">        res = <span class="string">"-"</span> + res;</div><div class="line">    <span class="keyword">return</span> res;</div><div class="line">&#125;</div><div class="line">istream &amp;<span class="keyword">operator</span>&gt;&gt;(istream &amp;in, BN &amp;num) &#123;</div><div class="line">    <span class="built_in">string</span> str;</div><div class="line">    in&gt;&gt;str;</div><div class="line">    num=str;</div><div class="line">    <span class="keyword">return</span> in;</div><div class="line">&#125;</div><div class="line">ostream &amp;<span class="keyword">operator</span>&lt;&lt;(ostream &amp;out, BN &amp;num) &#123;</div><div class="line">    out&lt;&lt;num.toStr();</div><div class="line">    <span class="keyword">return</span> out;</div><div class="line">&#125;</div><div class="line">BN BN::<span class="keyword">operator</span>=(<span class="keyword">const</span> <span class="keyword">char</span> *num) &#123;</div><div class="line">    <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="keyword">sizeof</span>(s));</div><div class="line">    <span class="keyword">char</span> a[MAX_L] = <span class="string">""</span>;</div><div class="line">    <span class="keyword">if</span> (num[<span class="number">0</span>] != <span class="string">'-'</span>)</div><div class="line">        <span class="built_in">strcpy</span>(a, num);</div><div class="line">    <span class="keyword">else</span></div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="built_in">strlen</span>(num); i++)</div><div class="line">            a[i - <span class="number">1</span>] = num[i];</div><div class="line">    sign = !(num[<span class="number">0</span>] == <span class="string">'-'</span>);</div><div class="line">    len = <span class="built_in">strlen</span>(a);</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(a); i++)</div><div class="line">        s[i] = a[len - i - <span class="number">1</span>] - <span class="number">48</span>;</div><div class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</div><div class="line">&#125;</div><div class="line">BN BN::<span class="keyword">operator</span>=(<span class="keyword">int</span> num) &#123;</div><div class="line">    <span class="keyword">char</span> temp[MAX_L];</div><div class="line">    <span class="built_in">sprintf</span>(temp, <span class="string">"%d"</span>, num);</div><div class="line">    *<span class="keyword">this</span> = temp;</div><div class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</div><div class="line">&#125;</div><div class="line">BN BN::<span class="keyword">operator</span>=(<span class="keyword">const</span> <span class="built_in">string</span> num) &#123;</div><div class="line">    <span class="keyword">const</span> <span class="keyword">char</span> *tmp;</div><div class="line">    tmp = num.c_str();</div><div class="line">    *<span class="keyword">this</span> = tmp;</div><div class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">bool</span> BN::<span class="keyword">operator</span>&lt;(<span class="keyword">const</span> BN &amp;num) <span class="keyword">const</span> &#123;</div><div class="line">    <span class="keyword">if</span> (sign^num.sign)</div><div class="line">        <span class="keyword">return</span> num.sign;</div><div class="line">    <span class="keyword">if</span> (len != num.len)</div><div class="line">        <span class="keyword">return</span> len &lt; num.len;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = len - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--)</div><div class="line">        <span class="keyword">if</span> (s[i] != num.s[i])</div><div class="line">            <span class="keyword">return</span> sign ? (s[i] &lt; num.s[i]) : (!(s[i] &lt; num.s[i]));</div><div class="line">    <span class="keyword">return</span> !sign;</div><div class="line">&#125;</div><div class="line"><span class="keyword">bool</span> BN::<span class="keyword">operator</span>&gt;(<span class="keyword">const</span> BN&amp;num)<span class="keyword">const</span> &#123;</div><div class="line">    <span class="keyword">return</span> num &lt; *<span class="keyword">this</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">bool</span> BN::<span class="keyword">operator</span>&lt;=(<span class="keyword">const</span> BN&amp;num)<span class="keyword">const</span> &#123;</div><div class="line">    <span class="keyword">return</span> !(*<span class="keyword">this</span>&gt;num);</div><div class="line">&#125;</div><div class="line"><span class="keyword">bool</span> BN::<span class="keyword">operator</span>&gt;=(<span class="keyword">const</span> BN&amp;num)<span class="keyword">const</span> &#123;</div><div class="line">    <span class="keyword">return</span> !(*<span class="keyword">this</span>&lt;num);</div><div class="line">&#125;</div><div class="line"><span class="keyword">bool</span> BN::<span class="keyword">operator</span>!=(<span class="keyword">const</span> BN&amp;num)<span class="keyword">const</span> &#123;</div><div class="line">    <span class="keyword">return</span> *<span class="keyword">this</span> &gt; num || *<span class="keyword">this</span> &lt; num;</div><div class="line">&#125;</div><div class="line"><span class="keyword">bool</span> BN::<span class="keyword">operator</span>==(<span class="keyword">const</span> BN&amp;num)<span class="keyword">const</span> &#123;</div><div class="line">    <span class="keyword">return</span> !(num != *<span class="keyword">this</span>);</div><div class="line">&#125;</div><div class="line">BN BN::<span class="keyword">operator</span>+(<span class="keyword">const</span> BN &amp;num) <span class="keyword">const</span> &#123;</div><div class="line">    <span class="keyword">if</span> (sign^num.sign) &#123;</div><div class="line">        BN tmp = sign ? num : *<span class="keyword">this</span>;</div><div class="line">        tmp.sign = <span class="number">1</span>;</div><div class="line">        <span class="keyword">return</span> sign ? *<span class="keyword">this</span> - tmp : num - tmp;</div><div class="line">    &#125;</div><div class="line">    BN result;</div><div class="line">    result.len = <span class="number">0</span>;</div><div class="line">    <span class="keyword">int</span> temp = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; temp || i &lt; (max(len, num.len)); i++) &#123;</div><div class="line">        <span class="keyword">int</span> t = s[i] + num.s[i] + temp;</div><div class="line">        result.s[result.len++] = t % <span class="number">10</span>;</div><div class="line">        temp = t / <span class="number">10</span>;</div><div class="line">    &#125;</div><div class="line">    result.sign = sign;</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">&#125;</div><div class="line">BN BN::<span class="keyword">operator</span>++() &#123;</div><div class="line">    *<span class="keyword">this</span> = *<span class="keyword">this</span> + <span class="number">1</span>;</div><div class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</div><div class="line">&#125;</div><div class="line">BN BN::<span class="keyword">operator</span>++(<span class="keyword">int</span>) &#123;</div><div class="line">    BN old = *<span class="keyword">this</span>;</div><div class="line">    ++(*<span class="keyword">this</span>);</div><div class="line">    <span class="keyword">return</span> old;</div><div class="line">&#125;</div><div class="line">BN BN::<span class="keyword">operator</span>+=(<span class="keyword">const</span> BN &amp;num) &#123;</div><div class="line">    *<span class="keyword">this</span> = *<span class="keyword">this</span> + num;</div><div class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</div><div class="line">&#125;</div><div class="line">BN BN::<span class="keyword">operator</span>-(<span class="keyword">const</span> BN &amp;num) <span class="keyword">const</span> &#123;</div><div class="line">    BN b=num,a=*<span class="keyword">this</span>;</div><div class="line">    <span class="keyword">if</span> (!num.sign &amp;&amp; !sign) &#123;</div><div class="line">        b.sign=<span class="number">1</span>;</div><div class="line">        a.sign=<span class="number">1</span>;</div><div class="line">        <span class="keyword">return</span> b-a;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (!b.sign) &#123;</div><div class="line">        b.sign=<span class="number">1</span>;</div><div class="line">        <span class="keyword">return</span> a+b;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (!a.sign) &#123;</div><div class="line">        a.sign=<span class="number">1</span>;</div><div class="line">        b=BN(<span class="number">0</span>)-(a+b);</div><div class="line">        <span class="keyword">return</span> b;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (a&lt;b) &#123;</div><div class="line">        BN c=(b-a);</div><div class="line">        c.sign=<span class="literal">false</span>;</div><div class="line">        <span class="keyword">return</span> c;</div><div class="line">    &#125;</div><div class="line">    BN result;</div><div class="line">    result.len = <span class="number">0</span>;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>, g = <span class="number">0</span>; i &lt; a.len; i++) &#123;</div><div class="line">        <span class="keyword">int</span> x = a.s[i] - g;</div><div class="line">        <span class="keyword">if</span> (i &lt; b.len) x -= b.s[i];</div><div class="line">        <span class="keyword">if</span> (x &gt;= <span class="number">0</span>) g = <span class="number">0</span>;</div><div class="line">        <span class="keyword">else</span> &#123;</div><div class="line">            g = <span class="number">1</span>;</div><div class="line">            x += <span class="number">10</span>;</div><div class="line">        &#125;</div><div class="line">        result.s[result.len++] = x;</div><div class="line">    &#125;</div><div class="line">    result.clean();</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">&#125;</div><div class="line">BN BN::<span class="keyword">operator</span> * (<span class="keyword">const</span> BN &amp;num)<span class="keyword">const</span> &#123;</div><div class="line">    BN result;</div><div class="line">    result.len = len + num.len;</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++)</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; num.len; j++)</div><div class="line">            result.s[i + j] += s[i] * num.s[j];</div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; result.len; i++) &#123;</div><div class="line">        result.s[i + <span class="number">1</span>] += result.s[i] / <span class="number">10</span>;</div><div class="line">        result.s[i] %= <span class="number">10</span>;</div><div class="line">    &#125;</div><div class="line">    result.clean();</div><div class="line">    result.sign = !(sign^num.sign);</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">&#125;</div><div class="line">BN BN::<span class="keyword">operator</span>*(<span class="keyword">const</span> <span class="keyword">int</span> num)<span class="keyword">const</span> &#123;</div><div class="line">    BN x = num;</div><div class="line">    BN z = *<span class="keyword">this</span>;</div><div class="line">    <span class="keyword">return</span> x*z;</div><div class="line">&#125;</div><div class="line">BN BN::<span class="keyword">operator</span>*=(<span class="keyword">const</span> BN&amp;num) &#123;</div><div class="line">    *<span class="keyword">this</span> = *<span class="keyword">this</span> * num;</div><div class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</div><div class="line">&#125;</div><div class="line">BN BN::<span class="keyword">operator</span> /(<span class="keyword">const</span> BN&amp;num)<span class="keyword">const</span> &#123;</div><div class="line">    BN ans;</div><div class="line">    ans.len = len - num.len + <span class="number">1</span>;</div><div class="line">    <span class="keyword">if</span> (ans.len &lt; <span class="number">0</span>) &#123;</div><div class="line">        ans.len = <span class="number">1</span>;</div><div class="line">        <span class="keyword">return</span> ans;</div><div class="line">    &#125;</div><div class="line">    BN divisor = *<span class="keyword">this</span>, divid = num;</div><div class="line">    divisor.sign = divid.sign = <span class="number">1</span>;</div><div class="line">    <span class="keyword">int</span> k = ans.len - <span class="number">1</span>;</div><div class="line">    <span class="keyword">int</span> j = len - <span class="number">1</span>;</div><div class="line">    <span class="keyword">while</span> (k &gt;= <span class="number">0</span>) &#123;</div><div class="line">        <span class="keyword">while</span> (divisor.s[j] == <span class="number">0</span>) j--;</div><div class="line">        <span class="keyword">if</span> (k &gt; j) k = j;</div><div class="line">        <span class="keyword">char</span> z[MAX_L];</div><div class="line">        <span class="built_in">memset</span>(z, <span class="number">0</span>, <span class="keyword">sizeof</span>(z));</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = j; i &gt;= k; i--)</div><div class="line">            z[j - i] = divisor.s[i] + <span class="string">'0'</span>;</div><div class="line">        BN dividend = z;</div><div class="line">        <span class="keyword">if</span> (dividend &lt; divid) &#123;</div><div class="line">            k--;</div><div class="line">            <span class="keyword">continue</span>;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">int</span> key = <span class="number">0</span>;</div><div class="line">        <span class="keyword">while</span> (divid*key &lt;= dividend) key++;</div><div class="line">        key--;</div><div class="line">        ans.s[k] = key;</div><div class="line">        BN temp = divid*key;</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++)</div><div class="line">            temp = temp * <span class="number">10</span>;</div><div class="line">        divisor = divisor - temp;</div><div class="line">        k--;</div><div class="line">    &#125;</div><div class="line">    ans.clean();</div><div class="line">    ans.sign = !(sign^num.sign);</div><div class="line">    <span class="keyword">return</span> ans;</div><div class="line">&#125;</div><div class="line">BN BN::<span class="keyword">operator</span>/=(<span class="keyword">const</span> BN&amp;num) &#123;</div><div class="line">    *<span class="keyword">this</span> = *<span class="keyword">this</span> / num;</div><div class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</div><div class="line">&#125;</div><div class="line">BN BN::<span class="keyword">operator</span>%(<span class="keyword">const</span> BN&amp; num)<span class="keyword">const</span> &#123;</div><div class="line">    BN a = *<span class="keyword">this</span>, b = num;</div><div class="line">    a.sign = b.sign = <span class="number">1</span>;</div><div class="line">    BN result, temp = a / b*b;</div><div class="line">    result = a - temp;</div><div class="line">    result.sign = sign;</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">&#125;</div><div class="line">BN BN::<span class="built_in">pow</span>(<span class="keyword">const</span> BN&amp; num)<span class="keyword">const</span> &#123;</div><div class="line">    BN result = <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> (BN i = <span class="number">0</span>; i &lt; num; i++)</div><div class="line">        result = result*(*<span class="keyword">this</span>);</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">&#125;</div><div class="line">BN BN::factorial()<span class="keyword">const</span> &#123;</div><div class="line">    BN result = <span class="number">1</span>;</div><div class="line">    <span class="keyword">for</span> (BN i = <span class="number">1</span>; i &lt;= *<span class="keyword">this</span>; i++)</div><div class="line">        result *= i;</div><div class="line">    <span class="keyword">return</span> result;</div><div class="line">&#125;</div><div class="line"><span class="keyword">void</span> BN::clean() &#123;</div><div class="line">    <span class="keyword">if</span> (len == <span class="number">0</span>) len++;</div><div class="line">    <span class="keyword">while</span> (len &gt; <span class="number">1</span> &amp;&amp; s[len - <span class="number">1</span>] == <span class="string">'\0'</span>)</div><div class="line">        len--;</div><div class="line">&#125;</div><div class="line">BN BN::Sqrt()<span class="keyword">const</span> &#123;</div><div class="line">    <span class="keyword">if</span>(*<span class="keyword">this</span>&lt;<span class="number">0</span>)<span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">    <span class="keyword">if</span>(*<span class="keyword">this</span>&lt;=<span class="number">1</span>)<span class="keyword">return</span> *<span class="keyword">this</span>;</div><div class="line">    BN l=<span class="number">0</span>,r=*<span class="keyword">this</span>,mid;</div><div class="line">    <span class="keyword">while</span>(r-l&gt;<span class="number">1</span>) &#123;</div><div class="line">        mid=(l+r)/<span class="number">2</span>;</div><div class="line">        <span class="keyword">if</span>(mid*mid&gt;*<span class="keyword">this</span>)</div><div class="line">            r=mid;</div><div class="line">        <span class="keyword">else</span></div><div class="line">            l=mid;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> l;</div><div class="line">&#125;</div><div class="line">BN::~BN() &#123;</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;<span class="keyword">return</span> <span class="number">0</span>;&#125;</div></pre></td></tr></table></figure>
<hr>
<p><strong>目前想到的只有这些啦</strong><br><del>如果有遗漏考场上现yy吧</del></p>
<p><strong>预祝NOIp2017 RP++ 頑張って！</strong><br><del>flag：拿了1=我就女装给你们看</del></p>
<hr>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/NOIP-复习/" rel="tag"># NOIP 复习</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/11/03/qbkqccd7/" rel="next" title="清北考前冲刺Day7">
                <i class="fa fa-chevron-left"></i> 清北考前冲刺Day7
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/11/12/noip2017/" rel="prev" title="NOIP2017 游记">
                NOIP2017 游记 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.png"
                alt="Yuki" />
            
              <p class="site-author-name" itemprop="name">Yuki</p>
              <p class="site-description motion-element" itemprop="description">I will follow this path until the end</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">18</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#最长公共子序列"><span class="nav-number">1.</span> <span class="nav-text">最长公共子序列</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#题目描述"><span class="nav-number">1.0.1.</span> <span class="nav-text">题目描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出格式"><span class="nav-number">1.0.2.</span> <span class="nav-text">输入输出格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出样例"><span class="nav-number">1.0.3.</span> <span class="nav-text">输入输出样例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#说明"><span class="nav-number">1.0.4.</span> <span class="nav-text">说明</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#最小（最大）生成树"><span class="nav-number">2.</span> <span class="nav-text">最小（最大）生成树</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#题目描述-1"><span class="nav-number">2.0.1.</span> <span class="nav-text">题目描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出格式-1"><span class="nav-number">2.0.2.</span> <span class="nav-text">输入输出格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出样例-1"><span class="nav-number">2.0.3.</span> <span class="nav-text">输入输出样例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#说明-1"><span class="nav-number">2.0.4.</span> <span class="nav-text">说明</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#并查集"><span class="nav-number">3.</span> <span class="nav-text">并查集</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#题目描述-2"><span class="nav-number">3.0.1.</span> <span class="nav-text">题目描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出格式-2"><span class="nav-number">3.0.2.</span> <span class="nav-text">输入输出格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出样例-2"><span class="nav-number">3.0.3.</span> <span class="nav-text">输入输出样例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#说明-2"><span class="nav-number">3.0.4.</span> <span class="nav-text">说明</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#单源最短路"><span class="nav-number">4.</span> <span class="nav-text">单源最短路</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#题目描述-3"><span class="nav-number">4.0.1.</span> <span class="nav-text">题目描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出格式-3"><span class="nav-number">4.0.2.</span> <span class="nav-text">输入输出格式</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#输入输出样例-3"><span class="nav-number">5.</span> <span class="nav-text">输入输出样例</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#说明-3"><span class="nav-number">5.0.1.</span> <span class="nav-text">说明</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#最近公共祖先（LCA）"><span class="nav-number">6.</span> <span class="nav-text">最近公共祖先（LCA）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#题目描述-4"><span class="nav-number">6.0.1.</span> <span class="nav-text">题目描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出格式-4"><span class="nav-number">6.0.2.</span> <span class="nav-text">输入输出格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出样例-4"><span class="nav-number">6.0.3.</span> <span class="nav-text">输入输出样例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#说明-4"><span class="nav-number">6.0.4.</span> <span class="nav-text">说明</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#负环"><span class="nav-number">7.</span> <span class="nav-text">负环</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#题目描述-5"><span class="nav-number">7.0.1.</span> <span class="nav-text">题目描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出格式-5"><span class="nav-number">7.0.2.</span> <span class="nav-text">输入输出格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出样例-5"><span class="nav-number">7.0.3.</span> <span class="nav-text">输入输出样例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#说明-5"><span class="nav-number">7.0.4.</span> <span class="nav-text">说明</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#缩点"><span class="nav-number">8.</span> <span class="nav-text">缩点</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#题目背景"><span class="nav-number">8.0.1.</span> <span class="nav-text">题目背景</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#题目描述-6"><span class="nav-number">8.0.2.</span> <span class="nav-text">题目描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出格式-6"><span class="nav-number">8.0.3.</span> <span class="nav-text">输入输出格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出样例-6"><span class="nav-number">8.0.4.</span> <span class="nav-text">输入输出样例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#说明-6"><span class="nav-number">8.0.5.</span> <span class="nav-text">说明</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#割点"><span class="nav-number">9.</span> <span class="nav-text">割点</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#题目背景-1"><span class="nav-number">9.0.1.</span> <span class="nav-text">题目背景</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#题目描述-7"><span class="nav-number">9.0.2.</span> <span class="nav-text">题目描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出格式-7"><span class="nav-number">9.0.3.</span> <span class="nav-text">输入输出格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出样例-7"><span class="nav-number">9.0.4.</span> <span class="nav-text">输入输出样例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#说明-7"><span class="nav-number">9.0.5.</span> <span class="nav-text">说明</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#网络最大流"><span class="nav-number">10.</span> <span class="nav-text">网络最大流</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#题目描述-8"><span class="nav-number">10.0.1.</span> <span class="nav-text">题目描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出格式-8"><span class="nav-number">10.0.2.</span> <span class="nav-text">输入输出格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出样例-8"><span class="nav-number">10.0.3.</span> <span class="nav-text">输入输出样例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#说明-8"><span class="nav-number">10.0.4.</span> <span class="nav-text">说明</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#二分图匹配"><span class="nav-number">11.</span> <span class="nav-text">二分图匹配</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#题目背景-2"><span class="nav-number">11.0.1.</span> <span class="nav-text">题目背景</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#题目描述-9"><span class="nav-number">11.0.2.</span> <span class="nav-text">题目描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出格式-9"><span class="nav-number">11.0.3.</span> <span class="nav-text">输入输出格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出样例-9"><span class="nav-number">11.0.4.</span> <span class="nav-text">输入输出样例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#说明-9"><span class="nav-number">11.0.5.</span> <span class="nav-text">说明</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#树状数组"><span class="nav-number">12.</span> <span class="nav-text">树状数组</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#题目描述-10"><span class="nav-number">12.0.1.</span> <span class="nav-text">题目描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出格式-10"><span class="nav-number">12.0.2.</span> <span class="nav-text">输入输出格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出样例-10"><span class="nav-number">12.0.3.</span> <span class="nav-text">输入输出样例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#说明-10"><span class="nav-number">12.0.4.</span> <span class="nav-text">说明</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#题目描述-11"><span class="nav-number">12.0.5.</span> <span class="nav-text">题目描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出格式-11"><span class="nav-number">12.0.6.</span> <span class="nav-text">输入输出格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出样例-11"><span class="nav-number">12.0.7.</span> <span class="nav-text">输入输出样例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#说明-11"><span class="nav-number">12.0.8.</span> <span class="nav-text">说明</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#线段树"><span class="nav-number">13.</span> <span class="nav-text">线段树</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#题目描述-12"><span class="nav-number">13.0.1.</span> <span class="nav-text">题目描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出格式-12"><span class="nav-number">13.0.2.</span> <span class="nav-text">输入输出格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出样例-12"><span class="nav-number">13.0.3.</span> <span class="nav-text">输入输出样例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#说明-12"><span class="nav-number">13.0.4.</span> <span class="nav-text">说明</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#题目描述-13"><span class="nav-number">13.0.5.</span> <span class="nav-text">题目描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出格式-13"><span class="nav-number">13.0.6.</span> <span class="nav-text">输入输出格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出样例-13"><span class="nav-number">13.0.7.</span> <span class="nav-text">输入输出样例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#说明-13"><span class="nav-number">13.0.8.</span> <span class="nav-text">说明</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ST表"><span class="nav-number">14.</span> <span class="nav-text">ST表</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#题目背景-3"><span class="nav-number">14.0.1.</span> <span class="nav-text">题目背景</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#题目描述-14"><span class="nav-number">14.0.2.</span> <span class="nav-text">题目描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出格式-14"><span class="nav-number">14.0.3.</span> <span class="nav-text">输入输出格式</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#输入输出样例-14"><span class="nav-number">15.</span> <span class="nav-text">输入输出样例</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#说明-14"><span class="nav-number">15.0.1.</span> <span class="nav-text">说明</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#矩阵快速幂"><span class="nav-number">16.</span> <span class="nav-text">矩阵快速幂</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#题目背景-4"><span class="nav-number">16.0.1.</span> <span class="nav-text">题目背景</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#题目描述-15"><span class="nav-number">16.0.2.</span> <span class="nav-text">题目描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出格式-15"><span class="nav-number">16.0.3.</span> <span class="nav-text">输入输出格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出样例-15"><span class="nav-number">16.0.4.</span> <span class="nav-text">输入输出样例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#说明-15"><span class="nav-number">16.0.5.</span> <span class="nav-text">说明</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#线性筛素数"><span class="nav-number">17.</span> <span class="nav-text">线性筛素数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#题目描述-16"><span class="nav-number">17.0.1.</span> <span class="nav-text">题目描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出格式-16"><span class="nav-number">17.0.2.</span> <span class="nav-text">输入输出格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出样例-16"><span class="nav-number">17.0.3.</span> <span class="nav-text">输入输出样例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#说明-16"><span class="nav-number">17.0.4.</span> <span class="nav-text">说明</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#乘法逆元"><span class="nav-number">18.</span> <span class="nav-text">乘法逆元</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#题目背景-5"><span class="nav-number">18.0.1.</span> <span class="nav-text">题目背景</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#题目描述-17"><span class="nav-number">18.0.2.</span> <span class="nav-text">题目描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出格式-17"><span class="nav-number">18.0.3.</span> <span class="nav-text">输入输出格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出样例-17"><span class="nav-number">18.0.4.</span> <span class="nav-text">输入输出样例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#说明-17"><span class="nav-number">18.0.5.</span> <span class="nav-text">说明</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#扩展欧几里得（EXGCD）"><span class="nav-number">19.</span> <span class="nav-text">扩展欧几里得（EXGCD）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#题目描述-18"><span class="nav-number">19.0.1.</span> <span class="nav-text">题目描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出格式-18"><span class="nav-number">19.0.2.</span> <span class="nav-text">输入输出格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出样例-18"><span class="nav-number">19.0.3.</span> <span class="nav-text">输入输出样例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#说明-18"><span class="nav-number">19.0.4.</span> <span class="nav-text">说明</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#字符串哈希"><span class="nav-number">20.</span> <span class="nav-text">字符串哈希</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#题目描述-19"><span class="nav-number">20.0.1.</span> <span class="nav-text">题目描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出格式-19"><span class="nav-number">20.0.2.</span> <span class="nav-text">输入输出格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出样例-19"><span class="nav-number">20.0.3.</span> <span class="nav-text">输入输出样例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#说明-19"><span class="nav-number">20.0.4.</span> <span class="nav-text">说明</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#KMP"><span class="nav-number">21.</span> <span class="nav-text">KMP</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#题目描述-20"><span class="nav-number">21.0.1.</span> <span class="nav-text">题目描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出格式-20"><span class="nav-number">21.0.2.</span> <span class="nav-text">输入输出格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出样例-20"><span class="nav-number">21.0.3.</span> <span class="nav-text">输入输出样例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#说明-20"><span class="nav-number">21.0.4.</span> <span class="nav-text">说明</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#AC自动机"><span class="nav-number">22.</span> <span class="nav-text">AC自动机</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#题目背景-6"><span class="nav-number">22.0.1.</span> <span class="nav-text">题目背景</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#题目描述-21"><span class="nav-number">22.0.2.</span> <span class="nav-text">题目描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出格式-21"><span class="nav-number">22.0.3.</span> <span class="nav-text">输入输出格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出样例-21"><span class="nav-number">22.0.4.</span> <span class="nav-text">输入输出样例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#说明-21"><span class="nav-number">22.0.5.</span> <span class="nav-text">说明</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#题目描述-22"><span class="nav-number">22.0.6.</span> <span class="nav-text">题目描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出格式-22"><span class="nav-number">22.0.7.</span> <span class="nav-text">输入输出格式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#输入输出样例-22"><span class="nav-number">22.0.8.</span> <span class="nav-text">输入输出样例</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#高精度"><span class="nav-number">23.</span> <span class="nav-text">高精度</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yuki</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme by &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Gemini</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
